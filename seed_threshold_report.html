<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Fire and summer temperatures interact to shape seed dormancy thresholds</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="seed_threshold_report_files/libs/clipboard/clipboard.min.js"></script>
<script src="seed_threshold_report_files/libs/quarto-html/quarto.js"></script>
<script src="seed_threshold_report_files/libs/quarto-html/popper.min.js"></script>
<script src="seed_threshold_report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="seed_threshold_report_files/libs/quarto-html/anchor.min.js"></script>
<link href="seed_threshold_report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="seed_threshold_report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="seed_threshold_report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="seed_threshold_report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="seed_threshold_report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="seed_threshold_report_files/libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="seed_threshold_report_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="seed_threshold_report_files/libs/datatables-binding-0.32/datatables.js"></script>
<script src="seed_threshold_report_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="seed_threshold_report_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="seed_threshold_report_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="seed_threshold_report_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="seed_threshold_report_files/libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="seed_threshold_report_files/libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="seed_threshold_report_files/libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="seed_threshold_report_files/libs/selectize-0.12.0/selectize.min.js"></script>
<link href="seed_threshold_report_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="seed_threshold_report_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
   
  <ul>
  <li><a href="#germination-curve-standardization" id="toc-germination-curve-standardization" class="nav-link active" data-scroll-target="#germination-curve-standardization"><span class="toc-section-number">1</span>  Germination curve standardization</a></li>
  <li><a href="#germination-indices" id="toc-germination-indices" class="nav-link" data-scroll-target="#germination-indices"><span class="toc-section-number">2</span>  Germination Indices</a></li>
  <li><a href="#germination-indices-plots" id="toc-germination-indices-plots" class="nav-link" data-scroll-target="#germination-indices-plots"><span class="toc-section-number">3</span>  Germination Indices Plots</a></li>
  <li><a href="#filter-data-to-maximum" id="toc-filter-data-to-maximum" class="nav-link" data-scroll-target="#filter-data-to-maximum"><span class="toc-section-number">4</span>  Filter data to maximum</a></li>
  <li><a href="#dose-response-curves" id="toc-dose-response-curves" class="nav-link" data-scroll-target="#dose-response-curves"><span class="toc-section-number">5</span>  Dose response curves</a></li>
  <li><a href="#effective-dose-lower-heat-threshold" id="toc-effective-dose-lower-heat-threshold" class="nav-link" data-scroll-target="#effective-dose-lower-heat-threshold"><span class="toc-section-number">6</span>  Effective dose ‘Lower heat threshold’</a></li>
  <li><a href="#combine-thresholds-with-climate-data" id="toc-combine-thresholds-with-climate-data" class="nav-link" data-scroll-target="#combine-thresholds-with-climate-data"><span class="toc-section-number">7</span>  Combine thresholds with climate data</a></li>
  <li><a href="#regression-variable-selection" id="toc-regression-variable-selection" class="nav-link" data-scroll-target="#regression-variable-selection"><span class="toc-section-number">8</span>  Regression variable selection</a></li>
  <li><a href="#final-model-results" id="toc-final-model-results" class="nav-link" data-scroll-target="#final-model-results"><span class="toc-section-number">9</span>  Final model results</a></li>
  <li><a href="#prediction-plot" id="toc-prediction-plot" class="nav-link" data-scroll-target="#prediction-plot"><span class="toc-section-number">10</span>  Prediction plot</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Fire and summer temperatures interact to shape seed dormancy thresholds</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">Zomer et al.&nbsp;2022</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="germination-curve-standardization" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="germination-curve-standardization"><span class="header-section-number">1</span> Germination curve standardization</h2>
<p>Germination data were plotted against the 19 experimental heat temperatures to obtain a germination curve for each population. Germination typically increases with heat until a maximum is reached at temperatures optimal for dormancy release (typically 80–110 °C for Cistus species), then begins to fall due to an increase in seed mortality at very high temperatures. The lowest heat treatment of 30 °C, equivalent to the mean temperature during the summer, was used to standardize the germination curve. This temperature has been previously shown to not break seed dormancy for our species, therefore germination at this heat treatment represents the fraction of non-dormant seeds. For each population, we removed this non-dormant fraction from the final analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check working directory</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/R"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#source functions for script</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="at">file=</span><span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/R/functions_seeds.R"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co">#combine charts together</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co">#combine plots</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer) <span class="co">#colour schemes</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcartocolor) <span class="co">#colour schemes</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT) <span class="co">#data table</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(drc) <span class="co">#dose response curves</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed models</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest) <span class="co">#p values lmer</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich) <span class="co">#model validation</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#check colinearity</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa) <span class="co">#check residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Read germination data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>seeds_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/germination_data.csv"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Show data in a table</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(seeds_data, <span class="at">filter =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-c992bcb4652781f35729" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c992bcb4652781f35729">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"20\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"30\" data-max=\"120\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"20\" data-max=\"25\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"25\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"8\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","975","976","977","978","979","980","981","982","983","984","985","986","987","988","989","990","991","992","993","994","995","996","997","998","999","1000","1001","1002","1003","1004","1005","1006","1007","1008","1009","1010","1011","1012","1013","1014","1015","1016","1017","1018","1019","1020","1021","1022","1023","1024","1025","1026","1027","1028","1029","1030","1031","1032","1033","1034","1035","1036","1037","1038","1039","1040","1041","1042","1043","1044","1045","1046","1047","1048","1049","1050","1051","1052","1053","1054","1055","1056","1057","1058","1059","1060","1061","1062","1063","1064","1065","1066","1067","1068","1069","1070","1071","1072","1073","1074","1075","1076","1077","1078","1079","1080","1081","1082","1083","1084","1085","1086","1087","1088","1089","1090","1091","1092","1093","1094","1095","1096","1097","1098","1099","1100","1101","1102","1103","1104","1105","1106","1107","1108","1109","1110","1111","1112","1113","1114","1115","1116","1117","1118","1119","1120","1121","1122","1123","1124","1125","1126","1127","1128","1129","1130","1131","1132","1133","1134","1135","1136","1137","1138","1139","1140","1141","1142","1143","1144","1145","1146","1147","1148","1149","1150","1151","1152","1153","1154","1155","1156","1157","1158","1159","1160","1161","1162","1163","1164","1165","1166","1167","1168","1169","1170","1171","1172","1173","1174","1175","1176","1177","1178","1179","1180","1181","1182","1183","1184","1185","1186","1187","1188","1189","1190","1191","1192","1193","1194","1195","1196","1197","1198","1199","1200","1201","1202","1203","1204","1205","1206","1207","1208","1209","1210","1211","1212","1213","1214","1215","1216","1217","1218","1219","1220","1221","1222","1223","1224","1225","1226","1227","1228","1229","1230","1231","1232","1233","1234","1235","1236","1237","1238","1239","1240","1241","1242","1243","1244","1245","1246","1247","1248","1249","1250","1251","1252","1253","1254","1255","1256","1257","1258","1259","1260","1261","1262","1263","1264","1265","1266","1267","1268","1269","1270","1271","1272","1273","1274","1275","1276","1277","1278","1279","1280","1281","1282","1283","1284","1285","1286","1287","1288","1289","1290","1291","1292","1293","1294","1295","1296","1297","1298","1299","1300","1301","1302","1303","1304","1305","1306","1307","1308","1309","1310","1311","1312","1313","1314","1315","1316","1317","1318","1319","1320","1321","1322","1323","1324","1325","1326","1327","1328","1329","1330","1331","1332","1333","1334","1335","1336","1337","1338","1339","1340","1341","1342","1343","1344","1345","1346","1347","1348","1349","1350","1351","1352","1353","1354","1355","1356","1357","1358","1359","1360","1361","1362","1363","1364","1365","1366","1367","1368","1369","1370","1371","1372","1373","1374","1375","1376","1377","1378","1379","1380","1381","1382","1383","1384","1385","1386","1387","1388","1389","1390","1391","1392","1393","1394","1395","1396","1397","1398","1399","1400","1401","1402","1403","1404","1405","1406","1407","1408","1409","1410","1411","1412","1413","1414","1415","1416","1417","1418","1419","1420","1421","1422","1423","1424","1425","1426","1427","1428","1429","1430","1431","1432","1433","1434","1435","1436","1437","1438","1439","1440","1441","1442","1443","1444","1445","1446","1447","1448","1449","1450","1451","1452","1453","1454","1455","1456","1457","1458","1459","1460","1461","1462","1463","1464","1465","1466","1467","1468","1469","1470","1471","1472","1473","1474","1475","1476","1477","1478","1479","1480","1481","1482","1483","1484","1485","1486","1487","1488","1489","1490","1491","1492","1493","1494","1495","1496","1497","1498","1499","1500","1501","1502","1503","1504","1505","1506","1507","1508","1509","1510","1511","1512","1513","1514","1515","1516","1517","1518","1519","1520","1521","1522","1523","1524","1525","1526","1527","1528","1529","1530","1531","1532","1533","1534","1535","1536","1537","1538","1539","1540","1541","1542","1543","1544","1545","1546","1547","1548","1549","1550","1551","1552","1553","1554","1555","1556","1557","1558","1559","1560","1561","1562","1563","1564","1565","1566","1567","1568","1569","1570","1571","1572","1573","1574","1575","1576","1577","1578","1579","1580","1581","1582","1583","1584","1585","1586","1587","1588","1589","1590","1591","1592","1593","1594","1595","1596","1597","1598","1599","1600","1601","1602","1603","1604","1605","1606","1607","1608","1609","1610","1611","1612","1613","1614","1615","1616","1617","1618","1619","1620","1621","1622","1623","1624","1625","1626","1627","1628","1629","1630","1631","1632","1633","1634","1635","1636","1637","1638","1639","1640","1641","1642","1643","1644","1645","1646","1647","1648","1649","1650","1651","1652","1653","1654","1655","1656","1657","1658","1659","1660","1661","1662","1663","1664","1665","1666","1667","1668","1669","1670","1671","1672","1673","1674","1675","1676","1677","1678","1679","1680","1681","1682","1683","1684","1685","1686","1687","1688","1689","1690","1691","1692","1693","1694","1695","1696","1697","1698","1699","1700","1701","1702","1703","1704","1705","1706","1707","1708","1709","1710","1711","1712","1713","1714","1715","1716","1717","1718","1719","1720","1721","1722","1723","1724","1725","1726","1727","1728","1729","1730","1731","1732","1733","1734","1735","1736","1737","1738","1739","1740","1741","1742","1743","1744","1745","1746","1747","1748","1749","1750","1751","1752","1753","1754","1755","1756","1757","1758","1759","1760","1761","1762","1763","1764","1765","1766","1767"],["CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CSA","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL","CAL"],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],[30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120,30,30,30,35,35,35,40,40,40,45,45,45,50,50,50,55,55,55,60,60,60,65,65,65,70,70,70,75,75,75,80,80,80,85,85,85,90,90,90,95,95,95,100,100,100,105,105,105,110,110,110,115,115,115,120,120,120],["I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III","I","II","III"],[25,24,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,20,25,20,20,25,20,20,25,20,20,25,20,20,24,20,20,25,20,20,25,20,20,25,20,20,25,20,20,25,20,20,25,20,20,25,20,20,25,20,20,25,20,20,25,20,20,25,20,20,25,20,20,25,20,20,25,20,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,20,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,24,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,23,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,24,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,22,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,20,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,22,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,23,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],[3,4,2,4,6,2,3,5,7,7,6,6,5,4,6,5,5,6,4,6,6,7,11,2,17,12,17,20,20,20,19,23,23,20,20,18,23,21,23,24,23,22,20,23,21,19,22,21,15,15,14,13,9,9,7,4,2,1,3,2,0,4,2,1,3,0,1,2,0,4,1,2,5,4,1,2,4,2,4,7,2,8,1,6,10,10,8,15,10,8,9,16,12,9,9,10,9,16,15,10,16,5,2,13,14,3,8,0,0,1,0,0,0,0,0,0,0,0,0,2,0,1,0,0,4,0,0,0,0,0,0,1,0,0,1,0,0,0,1,2,0,6,7,2,6,5,15,11,6,10,16,5,10,21,4,8,17,10,12,17,14,11,17,15,10,12,19,13,13,11,18,0,1,1,4,1,3,0,1,2,0,1,0,6,2,1,4,1,1,2,0,0,4,1,0,3,11,7,12,12,5,14,15,17,18,7,11,14,14,21,15,18,22,21,16,11,17,17,6,15,10,15,16,14,7,6,5,4,2,2,1,4,1,1,1,4,2,1,2,3,2,2,0,2,2,2,2,2,6,3,1,2,6,7,9,16,15,7,15,17,4,16,16,15,20,20,10,20,21,15,21,8,13,23,17,18,20,9,10,12,11,14,17,10,9,2,2,2,1,3,2,2,0,2,3,0,1,1,5,2,3,0,1,2,4,4,1,2,3,3,8,3,11,4,5,6,20,5,10,14,12,15,8,9,16,6,16,12,20,17,17,12,13,19,17,19,15,7,16,15,8,7,2,3,0,4,3,1,3,2,1,2,2,1,3,3,2,1,2,3,0,1,1,4,3,2,6,6,7,12,14,8,9,15,12,14,15,15,18,17,17,24,20,14,23,14,17,23,20,20,19,16,20,10,20,17,18,14,11,10,6,6,12,7,8,2,5,4,3,3,4,7,7,3,7,4,6,9,10,4,7,3,7,11,9,9,16,14,19,23,22,19,18,14,18,17,17,23,21,15,18,21,22,23,16,19,17,17,15,20,12,11,9,11,10,8,3,3,1,2,2,1,4,1,8,3,7,2,3,4,4,2,3,5,3,3,5,6,7,5,10,5,13,14,13,15,7,16,12,16,14,17,20,17,15,16,16,19,19,20,20,15,14,18,18,14,15,12,12,8,12,6,11,4,3,6,7,6,4,3,5,10,3,5,5,7,4,3,7,9,5,6,7,3,8,2,10,7,13,16,16,23,18,18,16,15,21,17,18,25,16,23,24,23,22,22,22,23,18,21,19,14,17,15,15,16,10,11,11,5,5,3,2,8,4,8,8,3,2,4,1,3,4,3,1,3,6,3,4,3,5,6,5,2,6,5,8,12,10,13,15,17,13,20,20,17,17,20,17,24,22,18,22,23,19,16,20,21,19,12,12,12,18,13,13,9,13,8,9,12,10,7,8,13,9,12,8,6,6,7,13,7,1,4,8,9,10,9,9,15,12,12,18,18,16,17,16,22,18,20,16,19,22,17,18,17,18,18,16,13,13,11,9,9,4,4,2,6,1,6,1,0,1,0,10,6,12,10,12,5,9,13,13,13,13,11,11,9,8,11,10,14,10,11,12,16,17,21,17,21,22,20,19,20,22,24,21,22,22,24,23,22,22,22,23,21,19,18,15,12,7,9,9,12,7,8,0,10,2,2,2,8,5,7,5,7,8,8,9,8,5,8,8,6,3,5,9,6,7,6,12,7,9,8,17,13,11,13,14,17,22,18,17,19,21,20,17,17,19,16,19,22,16,11,20,10,12,14,10,5,9,10,6,5,6,1,1,3,8,8,11,7,9,12,10,9,10,12,8,10,13,5,11,8,7,9,12,12,12,12,10,12,19,16,15,20,12,14,17,15,15,19,22,18,12,14,19,17,13,13,7,11,8,2,4,3,1,3,0,0,1,0,0,0,0,2,5,6,4,5,10,4,5,3,9,6,3,9,5,5,3,7,7,2,8,11,12,13,11,17,19,14,20,12,20,19,15,21,18,15,18,21,14,15,19,20,19,9,18,19,9,11,5,6,5,5,2,1,1,0,0,0,5,4,2,7,9,9,10,6,7,7,7,5,9,6,8,5,7,6,5,12,11,15,16,11,16,20,21,20,15,19,20,14,22,20,21,16,22,22,18,20,17,19,13,14,15,12,12,6,9,6,12,3,7,5,0,0,0,6,5,3,2,3,4,3,3,2,4,3,5,4,1,5,0,3,3,5,8,4,4,8,6,4,12,11,16,11,12,15,16,18,16,18,21,19,20,16,17,18,14,13,16,15,10,13,12,8,5,9,8,8,6,2,6,8,7,6,7,5,9,10,14,5,7,6,11,14,5,10,1,10,9,11,10,9,12,8,16,12,13,14,17,15,13,15,17,18,17,13,16,15,16,13,13,10,14,11,5,10,12,2,4,2,2,1,1,1,0,0,0,0,0,8,5,7,8,6,9,4,9,5,4,4,9,8,7,9,8,2,6,6,8,7,9,12,16,9,11,12,16,18,13,19,14,15,16,13,21,12,15,19,10,21,15,15,16,10,2,7,7,5,10,5,3,3,1,0,0,0,8,5,9,7,10,8,2,7,5,3,2,7,6,11,4,8,6,3,6,6,10,10,12,15,5,14,14,13,13,17,18,15,17,13,15,18,15,18,16,20,11,13,8,12,9,5,7,1,0,3,2,0,2,1,0,0,0,5,5,8,2,9,11,7,9,11,4,10,8,5,9,10,3,8,9,8,10,11,14,11,13,16,9,13,16,18,19,14,19,13,16,13,13,13,15,14,12,14,15,12,8,6,7,6,6,1,3,9,0,2,3,0,0,0,8,4,9,1,3,6,6,4,7,2,6,6,7,2,10,4,10,9,11,3,4,6,11,9,15,14,14,16,10,17,21,12,17,16,14,18,18,13,16,16,17,21,9,11,15,7,6,7,11,8,7,6,1,7,0,3,1,9,16,15,13,18,19,9,14,17,12,15,11,16,19,15,16,15,10,12,14,13,16,16,15,19,20,18,19,20,20,17,13,21,19,20,13,18,18,19,14,15,18,10,11,5,0,5,3,1,2,1,1,3,1,0,0,1,8,5,7,4,7,7,4,10,9,5,10,6,8,8,8,7,7,6,9,8,7,7,14,8,9,15,17,16,11,15,14,13,15,12,12,12,17,18,18,8,13,14,7,11,7,4,3,2,2,5,2,2,5,2,0,1,0,4,6,3,3,6,2,5,1,2,5,6,5,5,0,4,1,0,6,5,3,4,4,15,6,11,16,11,13,12,18,23,23,23,21,18,13,23,20,19,22,18,16,19,19,16,19,16,19,12,16,13,8,5,6,2,4,4,7,5,10,7,9,3,2,2,7,3,6,6,6,1,7,3,5,5,4,1,4,7,13,8,14,16,22,22,16,17,21,17,18,15,21,16,16,19,12,15,17,11,10,9,7,9,7,8,7,9,5,2,3,4,0,0,1,11,5,5,10,7,11,3,3,4,5,9,6,4,6,3,2,1,3,4,9,4,5,13,7,15,11,10,18,12,12,17,11,20,21,16,14,20,21,16,12,18,11,12,15,12,12,10,5,6,9,3,1,3,4,1,0,0,7,8,9,7,4,9,7,4,6,5,8,4,4,4,8,10,4,9,4,9,5,4,7,13,15,9,14,15,5,8,10,13,16,11,15,7,9,16,17,10,11,8,1,14,8,1,6,1,3,1,2,0,0,1,0,1,0,5,6,5,5,4,7,1,9,4,5,10,5,9,6,7,3,5,4,7,10,4,6,9,11,16,19,21,18,18,18,17,15,16,21,19,14,15,11,9,11,18,10,6,13,16,6,6,5,8,6,2,4,3,2,0,0,0,2,5,4,1,3,3,9,4,5,9,10,6,5,5,5,4,3,4,6,6,7,10,9,13,10,18,6,15,13,17,21,17,21,20,17,16,21,18,19,19,20,12,14,14,5,13,14,5,9,12,16,4,6,5,4,0,1],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,3,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,5,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,1,2,null,1,1,null,1,1,null,null,1,null,5,1,null,2,4,1,1,null,1,1,1,5,3,3,2,1,2,3,3,2,2,2,2,2,null,2,2,2,3,null,null,null,null,null,null,null,null,null,null,null,null,null,3,2,null,2,null,null,null,null,null,1,null,null,2,1,null,1,1,1,1,null,null,2,1,2,1,1,null,1,2,2,null,4,2,2,1,1,2,1,null,2,1,1,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,2,null,null,1,null,null,1,1,null,1,null,null,1,2,2,3,2,2,null,null,1,1,null,null,1,null,2,null,null,1,1,null,1,1,2,1,2,2,1,null,3,1,2,3,1,2,1,null,null,1,1,null,2,null,null,1,null,3,4,null,4,null,null,1,null,null,2,3,null,null,2,null,null,null,1,1,2,1,1,1,null,null,null,1,2,null,null,2,2,3,3,3,5,3,3,3,3,null,4,3,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,2,null,1,null,null,null,2,null,null,2,2,null,1,null,null,2,null,1,1,1,1,2,1,2,5,null,null,null,null,2,null,null,null,null,null,null,2,null,null,null,1,null,1,null,null,2,null,null,null,null,null,1,null,1,2,null,null,null,null,2,null,null,null,4,null,1,2,null,1,3,null,1,3,null,1,null,null,1,4,null,2,null,null,null,null,null,2,null,null,null,null,1,null,2,1,null,4,2,null,2,4,null,6,3,null,5,1,null,3,4,null,3,3,7,1,2,6,4,3,6,5,null,3,2,1,4,5,1,3,4,2,3,3,3,3,1,3,null,null,null,null,null,null,null,null,null,null,1,null,null,2,null,null,2,3,null,3,3,null,null,1,null,5,null,2,6,3,3,1,2,3,2,2,1,null,2,2,3,2,3,1,3,2,3,null,4,8,3,5,1,3,3,null,3,4,null,null,null,null,null,null,null,null,null,null,null,null,1,1,null,2,2,null,3,1,null,2,2,null,1,5,null,4,4,4,1,1,4,2,2,4,3,1,3,1,2,2,4,null,2,4,2,3,5,null,3,1,1,3,3,2,null,null,null,null,1,null,null,1,null,null,null,null,null,null,3,null,4,4,null,4,6,null,4,2,1,1,4,5,2,1,3,5,5,5,1,3,3,3,2,5,2,1,2,1,1,6,3,3,6,2,3,1,3,4,5,1,2,4,null,null,null,null,null,null,null,null,null,null,null,null,4,null,null,null,4,null,null,4,null,2,null,null,2,2,2,1,2,null,3,2,4,3,null,5,null,null,3,2,null,3,null,null,2,7,null,6,3,null,6,7,null,6,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,3,4,null,3,2,null,null,2,null,2,1,null,1,null,null,null,1,3,3,1,3,3,1,1,6,2,4,3,null,1,3,1,2,2,2,4,5,1,3,2,1,4,1,1,4,null,null,null,null,null,2,null,2,null,2,2,null,1,null,null,null,null,null,null,null,null,null,1,null,null,2,null,1,null,null,null,1,null,2,null,null,2,null,2,2,null,1,null,1,null,3,2,1,1,2,3,2,2,3,1,1,null,2,1,null,1,null,2,null,null,null,null,null,null,null,2,null,1,2,null,1,2,null,null,null,null,1,2,3,1,2,null,1,null,1,null,4,4,null,null,3,2,2,1,1,2,2,3,3,null,2,2,3,2,2,2,null,2,null,null,null,null,null,null,null,null,null,null,null,null,null,1,1,null,1,1,null,1,1,null,null,null,null,null,null,null,null,null,null,1,1,1,null,null,null,1,null,1,null,null,null,1,null,null,1,1,null,1,null,null,2,1,null,null,1,2,1,1,null,1,null,null,null,1,null,null,1,null,1,null,null,null,2,null,null,null,null,1,null,null,null,1,null,1,null,1,1,2,null,null,1,1,null,1,1,1,null,1,1,1,null,null,1,2,2,2,2,2,1,5,3,1,3,null,null,null,3,null,null,null,null,null,null,null,null,1,null,null,null,null,null,1,null,null,null,1,null,null,null,null,null,null,2,null,null,3,1,1,null,1,1,null,1,2,1,null,null,null,1,4,null,1,2,2,null,1,2,2,1,4,1,null,null,2,null,null,null,null,null,null,null,null,3,1,null,5,1,null,2,4,null,1,1,null,3,5,2,5,1,5,null,null,2,1,2,2,6,5,8,4,2,4,5,6,4,4,6,4,5,3,5,6,5,null,3,3,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,3,null,null,1,null,3,null,null,1,1,null,1,null,null,null,1,null,1,2,1,1,1,null,null,null,1,1,2,1,1,2,null,1,2,2,1,1,2,1,null,2,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,1,1,null,1,null,null,1,null,null,1,null,null,null,2,null,1,1,3,1,null,3,1,null,1,null,2,1,2,null,1,1,null,null,2,null,1,1,2,2,null,1,1,1,null,null,null,1,null,1,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>species<\/th>\n      <th>population<\/th>\n      <th>heat_treatment<\/th>\n      <th>replicate<\/th>\n      <th>total_seeds<\/th>\n      <th>germinated_seeds<\/th>\n      <th>empty_seeds<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,5,6,7]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"species","targets":1},{"name":"population","targets":2},{"name":"heat_treatment","targets":3},{"name":"replicate","targets":4},{"name":"total_seeds","targets":5},{"name":"germinated_seeds","targets":6},{"name":"empty_seeds","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate germination percentage</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#remove empty seeds from total seeds, and calculate percentage germinated of new total</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>seeds_data <span class="ot">&lt;-</span> seeds_data <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_total_seeds =</span> total_seeds <span class="sc">-</span> <span class="fu">coalesce</span>(empty_seeds, <span class="dv">0</span>),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">germination_percentage =</span> (germinated_seeds <span class="sc">/</span> new_total_seeds) <span class="sc">*</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Standardize for non-dormant seeds ------</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean germination percentage for the '30' heat treatment: represent non-dormant seeds</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>mean_gp_control <span class="ot">&lt;-</span> seeds_data <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(heat_treatment <span class="sc">==</span> <span class="st">'30'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, population) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">gp_control =</span> <span class="fu">mean</span>(germination_percentage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge mean germination data back into the original data frame</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize: germination_percentage - % non dormant seeds) / (100 %  - non dormant seeds%) *100</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Subtracting the non-dormant seeds percentage from 100% provides the percentage of viable seeds that could potentially germinate </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># under optimal conditions</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate both percentage gp and decimal form gd</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> seeds_data <span class="sc">%&gt;%</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mean_gp_control, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"species"</span>, <span class="st">"population"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gp_standardized =</span> (germination_percentage <span class="sc">-</span> gp_control) <span class="sc">/</span> (<span class="dv">100</span> <span class="sc">-</span> gp_control) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">gd_standardized =</span> (germination_percentage <span class="sc">-</span> gp_control) <span class="sc">/</span> (<span class="dv">100</span> <span class="sc">-</span> gp_control))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="germination-indices" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="germination-indices"><span class="header-section-number">2</span> Germination Indices</h2>
<p>Maximum germination and the corresponding heat treatment were identified for each population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Maximum germination and corresponding heat treatment for each population -----</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean_standardized germination of the three replicates for each species, population, and heat treatment</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>mean_standardized <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, population, heat_treatment) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_gp_standardized =</span> <span class="fu">mean</span>(gp_standardized))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the maximum mean_standardized germination for each species and population</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>max_standardized <span class="ot">&lt;-</span> mean_standardized <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, population) <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mean_gp_standardized <span class="sc">==</span> <span class="fu">max</span>(mean_gp_standardized)) <span class="sc">%&gt;%</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename 'heat_treatment' column in 'max_standardized' to 'max_heat_treatment' and mean_gp to max_gp_mean</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>max_standardized <span class="ot">&lt;-</span> max_standardized <span class="sc">%&gt;%</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">max_heat_treatment =</span> heat_treatment,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">max_gp_mean =</span> mean_gp_standardized)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge 'max_standardized' back into 'merged_data'</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(max_standardized, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"species"</span>, <span class="st">"population"</span>))</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Set gp_standardized and gd_standardized in heat treatment 30 to 0</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co"># subtracting the mean of the control treatment from itself (each replicate) does not provide useful information </span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gp_standardized =</span> <span class="fu">ifelse</span>(heat_treatment <span class="sc">==</span> <span class="st">'30'</span>, <span class="dv">0</span>, gp_standardized),</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">gd_standardized =</span> <span class="fu">ifelse</span>(heat_treatment <span class="sc">==</span> <span class="st">'30'</span>, <span class="dv">0</span>, gd_standardized))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Save new dataframe as RDS file</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(final_data, <span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/final_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="germination-indices-plots" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="germination-indices-plots"><span class="header-section-number">3</span> Germination Indices Plots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plots ----</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#set colour scheme</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>my_palette <span class="ot">&lt;-</span> rcartocolor<span class="sc">::</span><span class="fu">carto_pal</span>(<span class="at">n =</span> <span class="dv">12</span>, <span class="at">name =</span> <span class="st">"Prism"</span>)[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>)]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set order of factor 'species'</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>max_standardized<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">factor</span>(max_standardized<span class="sc">$</span>species, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"CAL"</span>, <span class="st">"CSA"</span>))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># jittered points for original data, set dodge width</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>dodge <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">5</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># box and whisker plot of maximum germination for each population</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">ggplot</span>(max_standardized, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> max_gp_mean, <span class="at">color =</span> species, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Maximum germination (%)"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> my_palette, <span class="at">guide =</span> <span class="fu">waiver</span>()) <span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> my_palette, <span class="at">guide =</span> <span class="fu">waiver</span>()) <span class="sc">+</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"CAL"</span> <span class="ot">=</span> <span class="st">"C. albidus"</span>, <span class="st">"CSA"</span> <span class="ot">=</span> <span class="st">"C. salviifolius"</span>)) <span class="sc">+</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic2</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">seed =</span> <span class="dv">0</span>),</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(max_standardized, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> max_heat_treatment, <span class="at">color =</span> species, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Heat for maximum germination (°C)"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> my_palette, <span class="at">guide =</span> <span class="fu">waiver</span>()) <span class="sc">+</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> my_palette, <span class="at">guide =</span> <span class="fu">waiver</span>()) <span class="sc">+</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"CAL"</span> <span class="ot">=</span> <span class="st">"C. albidus"</span>, <span class="st">"CSA"</span> <span class="ot">=</span> <span class="st">"C. salviifolius"</span>)) <span class="sc">+</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic2</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">seed =</span> <span class="dv">0</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, )</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange plots patchwork</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>a <span class="sc">+</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="seed_threshold_report_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="filter-data-to-maximum" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="filter-data-to-maximum"><span class="header-section-number">4</span> Filter data to maximum</h2>
<p>For the following models, we used only the first part of the germination curve, i.e.&nbsp;up to the maximum germination (for each population). In this section, we filter data to limit data at maximum germination and corresponding heat treatment. If there are two similar peaks in germination, we manually select the second.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data to limit data at maximum germination and corresponding heat treatment</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#upload clean data</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/final_data.rds"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define custom function to select peak heat and filter data</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>select_peak_and_filter <span class="ot">&lt;-</span> <span class="cf">function</span>(data, population, max_heat_treatment) {</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print population</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Population:"</span>, population, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get unique maximum heat treatment value for the population</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  unique_max_heat_treatment <span class="ot">&lt;-</span> <span class="fu">unique</span>(max_heat_treatment)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the maximum heat treatment value (if it's unique)</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(unique_max_heat_treatment) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Max Treatment:"</span>, unique_max_heat_treatment, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate mean germination percentage for each heat treatment</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  mean_germination <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(species, population, heat_treatment) <span class="sc">%&gt;%</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean_gp =</span> <span class="fu">mean</span>(gp_standardized))</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot mean germination percentage</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(mean_germination<span class="sc">$</span>heat_treatment, mean_germination<span class="sc">$</span>mean_gp, </span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">"o"</span>, </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Heat Treatment"</span>, </span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Mean Germination Percentage"</span>,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Mean Germination Percentage vs. Heat Treatment for Population:"</span>, population, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Max Treatment:"</span>, unique_max_heat_treatment))</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Customize x-axis to split by 5 degrees</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(mean_germination<span class="sc">$</span>heat_treatment), <span class="at">by =</span> <span class="dv">5</span>))</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Allow user to select peak interactively</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  peak <span class="ot">&lt;-</span> <span class="fu">readline</span>(<span class="at">prompt =</span> <span class="st">"Enter peak (y/n): "</span>)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">tolower</span>(peak) <span class="sc">==</span> <span class="st">"y"</span>) {</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    peak_value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">readline</span>(<span class="at">prompt =</span> <span class="st">"Enter peak value: "</span>))</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data based on peak heat treatment</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>heat_treatment <span class="sc">&lt;=</span> peak_value, ]</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(filtered_data)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If peak is not selected, use the original max_heat_treatment value for filtering</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    max_heat_treatment <span class="ot">&lt;-</span> <span class="fu">max</span>(max_heat_treatment)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    filtered_data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>heat_treatment <span class="sc">&lt;=</span> max_heat_treatment, ]</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(filtered_data)</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into separate data frames for each population of Cistus salviifolius</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>csapop_split <span class="ot">&lt;-</span> <span class="fu">split</span>(data[data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"CSA"</span>, ], data[data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"CSA"</span>, ]<span class="sc">$</span>population)</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into separate data frames for each population of Cistus albidus</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>calpop_split <span class="ot">&lt;-</span> <span class="fu">split</span>(data[data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"CAL"</span>, ], data[data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"CAL"</span>, ]<span class="sc">$</span>population)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select peak CSA</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pass through population plots one by one</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#approve or manually set peak heat</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#csa 3 change to 120 ;csa 10 to 100</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>csa_populations <span class="ot">&lt;-</span> <span class="fu">Map</span>(select_peak_and_filter, csapop_split, <span class="fu">names</span>(csapop_split), <span class="fu">lapply</span>(csapop_split, <span class="cf">function</span>(data) data<span class="sc">$</span>max_heat_treatment))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="csa_pop1_peak.png" class="img-fluid"></p>
<p>Population: 1</p>
<p>Max Treatment: 95</p>
<p>Enter peak (y/n):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select peak CAL</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pass through population plots one by one</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#approve or manually set peak heat</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#cal 3 change to 95 ;cal 8 to 90; cal 11 to 95; cal 13 to 90; cal 15 to 105 \# cal 18 to 90; cal 19 to 85; cal 20 to 90</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>cal_populations <span class="ot">&lt;-</span> <span class="fu">Map</span>(select_peak_and_filter, calpop_split, <span class="fu">names</span>(calpop_split), <span class="fu">lapply</span>(calpop_split, <span class="cf">function</span>(data) data<span class="sc">$</span>max_heat_treatment))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="cal1_peak.png" class="img-fluid"></p>
<p>Population: 1</p>
<p>Max Treatment: 80</p>
<p>Enter peak (y/n):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Save as dataframes</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>combined_csa <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(csa_populations, <span class="at">.id =</span> <span class="st">"population_id"</span>) </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>combined_cal <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cal_populations, <span class="at">.id =</span> <span class="st">"population_id"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Save filtered data as RDS file</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(combined_csa, <span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/filtered_csa_data.rds"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(combined_cal, <span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/filtered_cal_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dose-response-curves" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="dose-response-curves"><span class="header-section-number">5</span> Dose response curves</h2>
<p>We used Dose response curves to predict the heat dose required for the response of seeds to reach the 20th, 30th, 40th, 50th and 60th percentiles of germination, with 95 % confidence intervals.</p>
<p>To do so, we fitted either a four-parameter non-linear Weibull or a four-parameter log-logistic function, chosen with the myselect function, according to the Akaike information criterion (AIC), log likelihood estimations and lack-of- fit test. Four parameters were necessary as the lower limits were not fixed at 0 after standardizing the curve for non-dormant seeds (there were a range of low heat treatments that likely caused mortality in non-dormant seeds, but didn’t stimulate germination in dormant ones).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#upload filtered data-----</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>csa <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/filtered_csa_data.rds"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>cal <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/filtered_cal_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#unfortunately mselect doesn't work when applied to a list or used in a function,</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#so we have to apply drm and mselect functions manually</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 1: models drm()</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 2: mselect (model) to select most parsimonous model type</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 3: rerun model with selected model type</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># germination decimal format used in order to later use effective dose (ED function) type 'absolute'</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Models----</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># (correct model already selected using mselect function - see section below)</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>model_csa_1 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"1"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>model_csa_2 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"2"</span>,], <span class="at">fct =</span> <span class="fu">W2.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>model_csa_3 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"3"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>model_csa_4 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"4"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>model_csa_5 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"5"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>model_csa_6 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"6"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>model_csa_7 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"7"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>model_csa_8 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"8"</span>,], <span class="at">fct =</span> <span class="fu">W2.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>model_csa_9 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"9"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>model_csa_10 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"10"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>model_csa_11 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"11"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>model_cal_1 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"1"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>model_cal_2 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"2"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>model_cal_3 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"3"</span>,], <span class="at">fct =</span> <span class="fu">W2.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>model_cal_4 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"4"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>model_cal_5 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"5"</span>,], <span class="at">fct =</span> <span class="fu">LL.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>model_cal_6 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"6"</span>,], <span class="at">fct =</span> <span class="fu">LL.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>model_cal_7 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"7"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>model_cal_8 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"8"</span>,], <span class="at">fct =</span> <span class="fu">W2.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>model_cal_9 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"9"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>model_cal_10 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"10"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>model_cal_11 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"11"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>model_cal_12 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"12"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>model_cal_13 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"13"</span>,], <span class="at">fct =</span> <span class="fu">LL.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>model_cal_14 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"14"</span>,], <span class="at">fct =</span> <span class="fu">LL.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>model_cal_15 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"15"</span>,], <span class="at">fct =</span> <span class="fu">W2.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>model_cal_16 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"16"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>model_cal_17 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"17"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>model_cal_18 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"18"</span>,], <span class="at">fct =</span> <span class="fu">LL.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>model_cal_19 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"19"</span>,], <span class="at">fct =</span> <span class="fu">W2.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>model_cal_20 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"20"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">### MySelect ------</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># four parameter log logistic curve (LL.4 or LL2.4) or four parameter Weibull curve (W1.4 or W2.4)</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_1, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_2, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_3, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_4, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_5, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_6, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_7, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_8, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_9, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_10, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_11, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_1, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_2, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_3, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_4, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_5, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_6, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_7, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_8, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_9, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_10, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_11, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_12, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_13, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_14, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_15, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_16, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_17, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_18, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_19, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_20, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model list</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_csa_1 =</span> model_csa_1, <span class="at">model_csa_2 =</span> model_csa_2, <span class="at">model_csa_3 =</span> model_csa_3, <span class="at">model_csa_4 =</span> model_csa_4, <span class="at">model_csa_5 =</span> model_csa_5, <span class="at">model_csa_6 =</span> model_csa_6,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_csa_7 =</span> model_csa_7, <span class="at">model_csa_8 =</span> model_csa_8, <span class="at">model_csa_9 =</span> model_csa_9, <span class="at">model_csa_10 =</span> model_csa_10, <span class="at">model_csa_11 =</span> model_csa_11,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_cal_1 =</span> model_cal_1, <span class="at">model_cal_2 =</span> model_cal_2, <span class="at">model_cal_3 =</span> model_cal_3, <span class="at">model_cal_4 =</span> model_cal_4, <span class="at">model_cal_5 =</span> model_cal_5, <span class="at">model_cal_6 =</span> model_cal_6, <span class="at">model_cal_7 =</span> model_cal_7,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_cal_8 =</span> model_cal_8, <span class="at">model_cal_9 =</span> model_cal_9, <span class="at">model_cal_10 =</span> model_cal_10, <span class="at">model_cal_11 =</span> model_cal_11, <span class="at">model_cal_12 =</span> model_cal_12, <span class="at">model_cal_13 =</span> model_cal_13,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_cal_14 =</span> model_cal_14, <span class="at">model_cal_15 =</span> model_cal_15, <span class="at">model_cal_16 =</span> model_cal_16, <span class="at">model_cal_17 =</span> model_cal_17, <span class="at">model_cal_18 =</span> model_cal_18, <span class="at">model_cal_19 =</span> model_cal_19,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_cal_20 =</span> model_cal_20</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Show model plots </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each model in the list and plot them</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (model_name <span class="cf">in</span> <span class="fu">names</span>(models)) {</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(models[[model_name]], <span class="at">main =</span> model_name)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wait for the plot to be closed</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  input <span class="ot">&lt;-</span> <span class="fu">readline</span>(<span class="at">prompt =</span> <span class="st">"Press Enter to continue..."</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="drc_csa1.png" class="img-fluid"></p>
<p><img src="drc_cal1.png" class="img-fluid"></p>
</section>
<section id="effective-dose-lower-heat-threshold" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="effective-dose-lower-heat-threshold"><span class="header-section-number">6</span> Effective dose ‘Lower heat threshold’</h2>
<p>From these models, the effective dose (ED) function was used to predict the effective heat doses, or ‘lower heat thresholds’ at which 20–60 % dormancy release occurs for each population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function for 'ed'</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ed <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ED</span>(x, <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>), <span class="at">type =</span> <span class="st">"absolute"</span>, <span class="at">interval =</span> <span class="st">"delta"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># apply ed function to the list of all models</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>ed.all <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models, <span class="at">FUN =</span> ed, <span class="at">simplify =</span> <span class="cn">FALSE</span>, <span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to dataframe</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>ed.df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind.data.frame, ed.all)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># export to csv</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ed.df, <span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/ed_all2.csv"</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># note: in csv model name and dormancy release level are combined in first column.</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co"># reformatted csv loaded in next section</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co"># e:1:0.2 = 0.2 or 20% dormancy release</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># e:1:0.3 = 30%</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co"># e:1:0.4 = 40%</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># e:1:0.5 = 50%</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># e:1:0.6 = 60%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combine-thresholds-with-climate-data" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="combine-thresholds-with-climate-data"><span class="header-section-number">7</span> Combine thresholds with climate data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reformatted effective dose csv</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ed.estimate <span class="ot">&lt;-</span> <span class="fu">read.csv</span>((<span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/ed.all.csv"</span>), <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># site characteristics, climate, fire, and seed mass variables</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">read.csv</span>((<span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/site_data.csv"</span>), <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">#merge</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>ed_climate <span class="ot">&lt;-</span> <span class="fu">merge</span>(sites, ed.estimate, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"species"</span>, <span class="st">"pop"</span>))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># clean data</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>ed_climate <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(ed_climate)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>ed_climate<span class="sc">$</span>Estimate <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(ed_climate<span class="sc">$</span>Estimate)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># export to csv</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(ed_climate, file = "input/ed_climate.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="regression-variable-selection" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="regression-variable-selection"><span class="header-section-number">8</span> Regression variable selection</h2>
<p>To test to what extent heat thresholds of each population were related to their local climate, a linear regression model was fitted to lower heat threshold estimates. Species, dormancy release level, latitude, bioclimatic, fire and seed mass variables were added to the model as fixed effects. We used a stepwise approach to select the most parsimonious model; each step was assessed with analysis of variance (ANOVA) test and AIC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#upload merged data</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ed_climate <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/ed_climate.csv"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Selection</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># add variables into model in order of contribution to variance</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to null model using ANOVA</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a null model</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>null_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Estimate <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> ed_climate)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># List of variables</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dormancy_release"</span>, <span class="st">"species"</span>, <span class="st">"BIO_05"</span>, <span class="st">"BIO_01"</span>, <span class="st">"elevation"</span>, <span class="st">"seed_mass"</span>, <span class="st">"BIO_12"</span>, <span class="st">"aridity_index"</span>, <span class="st">"burned_area_percent"</span>, <span class="st">"annual_number_fires"</span>, <span class="st">"lat"</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA for each variable</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> variables) {</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the null model with the current variable</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  updated_model <span class="ot">&lt;-</span> <span class="fu">update</span>(null_model, <span class="fu">reformulate</span>(var, <span class="at">response =</span> <span class="st">"Estimate"</span>), <span class="at">data =</span> ed_climate)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform ANOVA</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  anova_result <span class="ot">&lt;-</span> <span class="fu">anova</span>(null_model, updated_model)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract p-value</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> anova_result[<span class="dv">2</span>, <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display results</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Variable:"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(updated_model), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">format</span>(p_value, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>) {</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"***</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.01</span>) {</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"**</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"*</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"ns</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variable: dormancy_release 
AIC: 931.8578 
p-value: 1.030963e-14 
***

Variable: species 
AIC: 953.0625 
p-value: 4.248621e-10 
***

Variable: BIO_05 
AIC: 965.3263 
p-value: 2.095973e-07 
***

Variable: BIO_01 
AIC: 976.0485 
p-value: 5.113839e-05 
***

Variable: elevation 
AIC: 977.6129 
p-value: 1.152968e-04 
***

Variable: seed_mass 
AIC: 992.609 
p-value: 7.165207e-01 
ns

Variable: BIO_12 
AIC: 990.6492 
p-value: 1.514509e-01 
ns

Variable: aridity_index 
AIC: 991.7721 
p-value: 3.286633e-01 
ns

Variable: burned_area_percent 
AIC: 992.5567 
p-value: 6.686802e-01 
ns

Variable: annual_number_fires 
AIC: 992.5191 
p-value: 6.389085e-01 
ns

Variable: lat 
AIC: 985.7697 
p-value: 8.851935e-03 
**</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#REPEAT until variables no longer contribute to variance</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Iteration 2</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a null model</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>null_model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Estimate <span class="sc">~</span> dormancy_release, <span class="at">data =</span> ed_climate)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>AIC_null_2 <span class="ot">&lt;-</span> <span class="fu">AIC</span>(null_model_2)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Null model AIC:"</span>, AIC_null_2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># List of variables</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>variables_2 <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"species"</span>, <span class="st">"BIO_05"</span>, <span class="st">"BIO_01"</span>, <span class="st">"elevation"</span>, <span class="st">"seed_mass"</span>, <span class="st">"BIO_12"</span>, <span class="st">"aridity_index"</span>, <span class="st">"burned_area_percent"</span>, <span class="st">"annual_number_fires"</span>, <span class="st">"lat"</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA for each variable</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> variables_2) {</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the null model with the current variable</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  updated_model_2 <span class="ot">&lt;-</span> <span class="fu">update</span>(null_model_2, <span class="fu">reformulate</span>(<span class="fu">c</span>(<span class="st">"dormancy_release"</span>, var), <span class="at">response =</span> <span class="st">"Estimate"</span>), <span class="at">data =</span> ed_climate)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform ANOVA</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  anova_result_2 <span class="ot">&lt;-</span> <span class="fu">anova</span>(null_model_2, updated_model_2)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract p-value</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> anova_result_2[<span class="dv">2</span>, <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display results</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Variable:"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(updated_model_2), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">format</span>(p_value, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>) {</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"***</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.01</span>) {</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"**</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"*</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"ns</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Iteration 3</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a null model</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>null_model_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Estimate <span class="sc">~</span> dormancy_release <span class="sc">+</span> species, <span class="at">data =</span> ed_climate)</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>AIC_null_3 <span class="ot">&lt;-</span> <span class="fu">AIC</span>(null_model_3)</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Null model AIC:"</span>, AIC_null_3, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a><span class="co"># List of variables</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>variables_3 <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"BIO_05"</span>, <span class="st">"BIO_01"</span>, <span class="st">"elevation"</span>, <span class="st">"seed_mass"</span>, <span class="st">"BIO_12"</span>, <span class="st">"aridity_index"</span>, <span class="st">"burned_area_percent"</span>, <span class="st">"annual_number_fires"</span>, <span class="st">"lat"</span>)</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA for each variable</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> variables_3) {</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the null model with the current variable</span></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>  updated_model_3 <span class="ot">&lt;-</span> <span class="fu">update</span>(null_model_3, <span class="fu">reformulate</span>(<span class="fu">c</span>(<span class="st">"dormancy_release"</span>, <span class="st">"species"</span>,var), <span class="at">response =</span> <span class="st">"Estimate"</span>), <span class="at">data =</span> ed_climate)</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform ANOVA</span></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>  anova_result_3 <span class="ot">&lt;-</span> <span class="fu">anova</span>(null_model_3, updated_model_3)</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract p-value</span></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> anova_result_3[<span class="fu">nrow</span>(anova_result_3), <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display results</span></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Variable:"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(updated_model_3), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">format</span>(p_value, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>) {</span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"***</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.01</span>) {</span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"**</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"*</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"ns</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a><span class="co">#Iteration 4</span></span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a null model</span></span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>null_model_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Estimate <span class="sc">~</span> dormancy_release <span class="sc">+</span> species <span class="sc">+</span>BIO_05, <span class="at">data =</span> ed_climate)</span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>AIC_null_4 <span class="ot">&lt;-</span> <span class="fu">AIC</span>(null_model_4)</span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Null model AIC:"</span>, AIC_null_4, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a><span class="co"># List of variables</span></span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>variables_4 <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"BIO_01"</span>, <span class="st">"elevation"</span>, <span class="st">"seed_mass"</span>, <span class="st">"BIO_12"</span>, <span class="st">"aridity_index"</span>, <span class="st">"burned_area_percent"</span>, <span class="st">"annual_number_fires"</span>, <span class="st">"lat"</span>)</span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA for each variable</span></span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> variables_4) {</span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the null model with the current variable</span></span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a>  updated_model_4 <span class="ot">&lt;-</span> <span class="fu">update</span>(null_model_4, <span class="fu">reformulate</span>(<span class="fu">c</span>(<span class="st">"dormancy_release"</span>, <span class="st">"species"</span>,<span class="st">"BIO_05"</span>,var), <span class="at">response =</span> <span class="st">"Estimate"</span>), <span class="at">data =</span> ed_climate)</span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform ANOVA</span></span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>  anova_result_4 <span class="ot">&lt;-</span> <span class="fu">anova</span>(null_model_4, updated_model_4)</span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract p-value</span></span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> anova_result_4[<span class="fu">nrow</span>(anova_result_4), <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display results</span></span>
<span id="cb23-98"><a href="#cb23-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Variable:"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-99"><a href="#cb23-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(updated_model_4), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-100"><a href="#cb23-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">format</span>(p_value, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-101"><a href="#cb23-101" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>) {</span>
<span id="cb23-102"><a href="#cb23-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"***</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-103"><a href="#cb23-103" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.01</span>) {</span>
<span id="cb23-104"><a href="#cb23-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"**</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-105"><a href="#cb23-105" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb23-106"><a href="#cb23-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"*</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-107"><a href="#cb23-107" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-108"><a href="#cb23-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"ns</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-109"><a href="#cb23-109" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-110"><a href="#cb23-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-111"><a href="#cb23-111" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="final-model-results" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="final-model-results"><span class="header-section-number">9</span> Final model results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linear regression with maximum temperature of warmest month (BIO_05), dormancy release %, and species as fixed factors</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Estimate <span class="sc">~</span> BIO_05 <span class="sc">*</span> dormancy_release <span class="sc">+</span> BIO_05 <span class="sc">*</span> species, ed_climate)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lm parameters</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(final_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Estimate
                         Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
BIO_05                    1 1382.95 1382.95  97.392 &lt; 2.2e-16 ***
dormancy_release          1 2762.30 2762.30 194.531 &lt; 2.2e-16 ***
species                   1 1304.79 1304.79  91.888 &lt; 2.2e-16 ***
BIO_05:dormancy_release   1  154.52  154.52  10.882  0.001236 ** 
BIO_05:species            1  412.88  412.88  29.076 2.936e-07 ***
Residuals               138 1959.58   14.20                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Estimate ~ BIO_05 * dormancy_release + BIO_05 * 
    species, data = ed_climate)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.7144 -2.5146 -0.2424  2.2801 12.1500 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              80.938745  16.633559   4.866 3.07e-06 ***
BIO_05                   -0.087925   0.061021  -1.441 0.151882    
dormancy_release         -0.990039   0.387271  -2.556 0.011656 *  
speciesCSA              -66.132356  13.464784  -4.912 2.52e-06 ***
BIO_05:dormancy_release   0.004775   0.001419   3.365 0.000991 ***
BIO_05:speciesCSA         0.263640   0.048893   5.392 2.94e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.768 on 138 degrees of freedom
Multiple R-squared:  0.7543,    Adjusted R-squared:  0.7454 
F-statistic: 84.75 on 5 and 138 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#residuals</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> final_model, <span class="at">plot =</span> F)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="seed_threshold_report_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="seed_threshold_report_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.97083, p-value = 0.848
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
<section id="prediction-plot" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="prediction-plot"><span class="header-section-number">10</span> Prediction plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate predictions</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' predict' base r to calculate predictions and confidence intervals</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>ed_climate<span class="sc">$</span>predlm <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># remove NA</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>ed_climate <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(ed_climate)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">#predict </span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>predslm.ed <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model, <span class="at">interval =</span> <span class="st">"confidence"</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">#combine predictions with climate</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>datlm <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ed_climate, predslm.ed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set colour scheme</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>my_pal3 <span class="ot">&lt;-</span> rcartocolor<span class="sc">::</span><span class="fu">carto_pal</span>(<span class="at">n =</span> <span class="dv">12</span>, <span class="at">name =</span> <span class="st">"Prism"</span>)[<span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">2</span>)]</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rename dormancy release levels</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>new_labels2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"20"</span> <span class="ot">=</span> <span class="st">"20"</span>, <span class="st">"30"</span> <span class="ot">=</span> <span class="st">"30  "</span>, <span class="st">"40"</span> <span class="ot">=</span> <span class="st">"40"</span>, <span class="st">"50"</span> <span class="ot">=</span> <span class="st">"50"</span>, <span class="st">"60"</span> <span class="ot">=</span> <span class="st">"60"</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># set species order</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>datlm<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">factor</span>(datlm<span class="sc">$</span>species, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"CSA"</span>, <span class="st">"CAL"</span>))</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot predicted linear regression with confidence intervals and raw data (points)</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datlm, <span class="fu">aes</span>(<span class="at">x =</span> BIO_05 <span class="sc">/</span> <span class="dv">10</span>, <span class="at">y =</span> Estimate, <span class="at">color =</span> species, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.27</span>) <span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr, <span class="at">colour =</span> <span class="cn">NULL</span>), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fit), <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> my_pal3, <span class="at">name =</span> <span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"C. salviifolius"</span>, <span class="st">"C. albidus"</span>)) <span class="sc">+</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> my_pal3, <span class="at">name =</span> <span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"C. salviifolius"</span>, <span class="st">"C. albidus"</span>)) <span class="sc">+</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="co"># facet grid to divide by dormancy release %</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="sc">~</span>dormancy_release, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">germ_per =</span> new_labels2))</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="co"># axes titles</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="st">"Maximum temperature of warmest month (°C)"</span>)) <span class="sc">+</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">" Lower heat threshold (°C)"</span>))</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="co"># format legend</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"NA"</span>)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.19</span>, <span class="fl">0.8</span>), <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="co"># legend position</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>), <span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Dormancy release (%)"</span>) <span class="sc">+</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.07</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="seed_threshold_report_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb33" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> 'Fire and summer temperatures interact to shape seed dormancy thresholds'</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> 'Zomer et al. 2022'</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: False</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: " "</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> source</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="an">fig-cap-location:</span><span class="co"> margin</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## Germination curve standardization</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>Germination data were plotted against the 19 experimental heat temperatures to obtain a germination curve for each population. Germination typically increases with heat until a maximum is reached at temperatures optimal for dormancy release (typically 80--110 °C for Cistus species), then begins to fall due to an increase in seed mortality at very high temperatures. The lowest heat treatment of 30 °C, equivalent to the mean temperature during the summer, was used to standardize the germination curve. This temperature has been previously shown to not break seed dormancy for our species, therefore germination at this heat treatment represents the fraction of non-dormant seeds. For each population, we removed this non-dormant fraction from the final analysis.</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co">#check working directory</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="co">#source functions for script</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="at">file=</span><span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/R/functions_seeds.R"</span>)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co">#combine charts together</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co">#combine plots</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer) <span class="co">#colour schemes</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcartocolor) <span class="co">#colour schemes</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT) <span class="co">#data table</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(drc) <span class="co">#dose response curves</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#mixed models</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest) <span class="co">#p values lmer</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich) <span class="co">#model validation</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co">#check colinearity</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa) <span class="co">#check residuals</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a><span class="do">### Read germination data</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>seeds_data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/germination_data.csv"</span>)</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Show data in a table</span></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(seeds_data, <span class="at">filter =</span> <span class="st">"top"</span>)</span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate germination percentage</span></span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a><span class="co">#remove empty seeds from total seeds, and calculate percentage germinated of new total</span></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>seeds_data <span class="ot">&lt;-</span> seeds_data <span class="sc">%&gt;%</span></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_total_seeds =</span> total_seeds <span class="sc">-</span> <span class="fu">coalesce</span>(empty_seeds, <span class="dv">0</span>),</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>         <span class="at">germination_percentage =</span> (germinated_seeds <span class="sc">/</span> new_total_seeds) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a><span class="co">#Standardize for non-dormant seeds ------</span></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean germination percentage for the '30' heat treatment: represent non-dormant seeds</span></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>mean_gp_control <span class="ot">&lt;-</span> seeds_data <span class="sc">%&gt;%</span></span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(heat_treatment <span class="sc">==</span> <span class="st">'30'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, population) <span class="sc">%&gt;%</span></span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">gp_control =</span> <span class="fu">mean</span>(germination_percentage, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge mean germination data back into the original data frame</span></span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize: germination_percentage - % non dormant seeds) / (100 %  - non dormant seeds%) *100</span></span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Subtracting the non-dormant seeds percentage from 100% provides the percentage of viable seeds that could potentially germinate </span></span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a><span class="co"># under optimal conditions</span></span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate both percentage gp and decimal form gd</span></span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> seeds_data <span class="sc">%&gt;%</span></span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mean_gp_control, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"species"</span>, <span class="st">"population"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gp_standardized =</span> (germination_percentage <span class="sc">-</span> gp_control) <span class="sc">/</span> (<span class="dv">100</span> <span class="sc">-</span> gp_control) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>         <span class="at">gd_standardized =</span> (germination_percentage <span class="sc">-</span> gp_control) <span class="sc">/</span> (<span class="dv">100</span> <span class="sc">-</span> gp_control))</span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a><span class="fu">## Germination Indices</span></span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a>Maximum germination and the corresponding heat treatment were identified for each population.</span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a><span class="co">#Maximum germination and corresponding heat treatment for each population -----</span></span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean_standardized germination of the three replicates for each species, population, and heat treatment</span></span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a>mean_standardized <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, population, heat_treatment) <span class="sc">%&gt;%</span></span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_gp_standardized =</span> <span class="fu">mean</span>(gp_standardized))</span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the maximum mean_standardized germination for each species and population</span></span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a>max_standardized <span class="ot">&lt;-</span> mean_standardized <span class="sc">%&gt;%</span></span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, population) <span class="sc">%&gt;%</span></span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mean_gp_standardized <span class="sc">==</span> <span class="fu">max</span>(mean_gp_standardized)) <span class="sc">%&gt;%</span></span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename 'heat_treatment' column in 'max_standardized' to 'max_heat_treatment' and mean_gp to max_gp_mean</span></span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a>max_standardized <span class="ot">&lt;-</span> max_standardized <span class="sc">%&gt;%</span></span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">max_heat_treatment =</span> heat_treatment,</span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true" tabindex="-1"></a>         <span class="at">max_gp_mean =</span> mean_gp_standardized)</span>
<span id="cb33-103"><a href="#cb33-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-104"><a href="#cb33-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge 'max_standardized' back into 'merged_data'</span></span>
<span id="cb33-105"><a href="#cb33-105" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb33-106"><a href="#cb33-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(max_standardized, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"species"</span>, <span class="st">"population"</span>))</span>
<span id="cb33-107"><a href="#cb33-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-108"><a href="#cb33-108" aria-hidden="true" tabindex="-1"></a><span class="co">#Set gp_standardized and gd_standardized in heat treatment 30 to 0</span></span>
<span id="cb33-109"><a href="#cb33-109" aria-hidden="true" tabindex="-1"></a><span class="co"># subtracting the mean of the control treatment from itself (each replicate) does not provide useful information </span></span>
<span id="cb33-110"><a href="#cb33-110" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb33-111"><a href="#cb33-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gp_standardized =</span> <span class="fu">ifelse</span>(heat_treatment <span class="sc">==</span> <span class="st">'30'</span>, <span class="dv">0</span>, gp_standardized),</span>
<span id="cb33-112"><a href="#cb33-112" aria-hidden="true" tabindex="-1"></a>         <span class="at">gd_standardized =</span> <span class="fu">ifelse</span>(heat_treatment <span class="sc">==</span> <span class="st">'30'</span>, <span class="dv">0</span>, gd_standardized))</span>
<span id="cb33-113"><a href="#cb33-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-114"><a href="#cb33-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-115"><a href="#cb33-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-116"><a href="#cb33-116" aria-hidden="true" tabindex="-1"></a><span class="co">#Save new dataframe as RDS file</span></span>
<span id="cb33-117"><a href="#cb33-117" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(final_data, <span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/final_data.rds"</span>)</span>
<span id="cb33-118"><a href="#cb33-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-119"><a href="#cb33-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-120"><a href="#cb33-120" aria-hidden="true" tabindex="-1"></a><span class="fu">## Germination Indices Plots</span></span>
<span id="cb33-121"><a href="#cb33-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-122"><a href="#cb33-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-123"><a href="#cb33-123" aria-hidden="true" tabindex="-1"></a><span class="co">#Plots ----</span></span>
<span id="cb33-124"><a href="#cb33-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-125"><a href="#cb33-125" aria-hidden="true" tabindex="-1"></a><span class="co">#set colour scheme</span></span>
<span id="cb33-126"><a href="#cb33-126" aria-hidden="true" tabindex="-1"></a>my_palette <span class="ot">&lt;-</span> rcartocolor<span class="sc">::</span><span class="fu">carto_pal</span>(<span class="at">n =</span> <span class="dv">12</span>, <span class="at">name =</span> <span class="st">"Prism"</span>)[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>)]</span>
<span id="cb33-127"><a href="#cb33-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-128"><a href="#cb33-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Set order of factor 'species'</span></span>
<span id="cb33-129"><a href="#cb33-129" aria-hidden="true" tabindex="-1"></a>max_standardized<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">factor</span>(max_standardized<span class="sc">$</span>species, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"CAL"</span>, <span class="st">"CSA"</span>))</span>
<span id="cb33-130"><a href="#cb33-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-131"><a href="#cb33-131" aria-hidden="true" tabindex="-1"></a><span class="co"># jittered points for original data, set dodge width</span></span>
<span id="cb33-132"><a href="#cb33-132" aria-hidden="true" tabindex="-1"></a>dodge <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">5</span>)</span>
<span id="cb33-133"><a href="#cb33-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-134"><a href="#cb33-134" aria-hidden="true" tabindex="-1"></a><span class="co"># box and whisker plot of maximum germination for each population</span></span>
<span id="cb33-135"><a href="#cb33-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-136"><a href="#cb33-136" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">ggplot</span>(max_standardized, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> max_gp_mean, <span class="at">color =</span> species, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb33-137"><a href="#cb33-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Maximum germination (%)"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb33-138"><a href="#cb33-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> my_palette, <span class="at">guide =</span> <span class="fu">waiver</span>()) <span class="sc">+</span></span>
<span id="cb33-139"><a href="#cb33-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> my_palette, <span class="at">guide =</span> <span class="fu">waiver</span>()) <span class="sc">+</span></span>
<span id="cb33-140"><a href="#cb33-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"CAL"</span> <span class="ot">=</span> <span class="st">"C. albidus"</span>, <span class="st">"CSA"</span> <span class="ot">=</span> <span class="st">"C. salviifolius"</span>)) <span class="sc">+</span></span>
<span id="cb33-141"><a href="#cb33-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb33-142"><a href="#cb33-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb33-143"><a href="#cb33-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic2</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb33-144"><a href="#cb33-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb33-145"><a href="#cb33-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">seed =</span> <span class="dv">0</span>),</span>
<span id="cb33-146"><a href="#cb33-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb33-147"><a href="#cb33-147" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-148"><a href="#cb33-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-149"><a href="#cb33-149" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(max_standardized, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> max_heat_treatment, <span class="at">color =</span> species, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb33-150"><a href="#cb33-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Heat for maximum germination (°C)"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb33-151"><a href="#cb33-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> my_palette, <span class="at">guide =</span> <span class="fu">waiver</span>()) <span class="sc">+</span></span>
<span id="cb33-152"><a href="#cb33-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> my_palette, <span class="at">guide =</span> <span class="fu">waiver</span>()) <span class="sc">+</span></span>
<span id="cb33-153"><a href="#cb33-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"CAL"</span> <span class="ot">=</span> <span class="st">"C. albidus"</span>, <span class="st">"CSA"</span> <span class="ot">=</span> <span class="st">"C. salviifolius"</span>)) <span class="sc">+</span></span>
<span id="cb33-154"><a href="#cb33-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb33-155"><a href="#cb33-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb33-156"><a href="#cb33-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic2</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb33-157"><a href="#cb33-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">seed =</span> <span class="dv">0</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, )</span>
<span id="cb33-158"><a href="#cb33-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-159"><a href="#cb33-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-160"><a href="#cb33-160" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange plots patchwork</span></span>
<span id="cb33-161"><a href="#cb33-161" aria-hidden="true" tabindex="-1"></a>a <span class="sc">+</span> b</span>
<span id="cb33-162"><a href="#cb33-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-163"><a href="#cb33-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-164"><a href="#cb33-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-165"><a href="#cb33-165" aria-hidden="true" tabindex="-1"></a><span class="fu">## Filter data to maximum</span></span>
<span id="cb33-166"><a href="#cb33-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-167"><a href="#cb33-167" aria-hidden="true" tabindex="-1"></a>For the following models, we used only the first part of the germination curve, i.e. up to the maximum germination (for each population). In this section, we filter data to limit data at maximum germination and corresponding heat treatment. If there are two similar peaks in germination, we manually select the second.</span>
<span id="cb33-168"><a href="#cb33-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-169"><a href="#cb33-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-170"><a href="#cb33-170" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data to limit data at maximum germination and corresponding heat treatment</span></span>
<span id="cb33-171"><a href="#cb33-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-172"><a href="#cb33-172" aria-hidden="true" tabindex="-1"></a><span class="co">#upload clean data</span></span>
<span id="cb33-173"><a href="#cb33-173" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/final_data.rds"</span>)</span>
<span id="cb33-174"><a href="#cb33-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-175"><a href="#cb33-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Define custom function to select peak heat and filter data</span></span>
<span id="cb33-176"><a href="#cb33-176" aria-hidden="true" tabindex="-1"></a>select_peak_and_filter <span class="ot">&lt;-</span> <span class="cf">function</span>(data, population, max_heat_treatment) {</span>
<span id="cb33-177"><a href="#cb33-177" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print population</span></span>
<span id="cb33-178"><a href="#cb33-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Population:"</span>, population, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-179"><a href="#cb33-179" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-180"><a href="#cb33-180" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get unique maximum heat treatment value for the population</span></span>
<span id="cb33-181"><a href="#cb33-181" aria-hidden="true" tabindex="-1"></a>  unique_max_heat_treatment <span class="ot">&lt;-</span> <span class="fu">unique</span>(max_heat_treatment)</span>
<span id="cb33-182"><a href="#cb33-182" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-183"><a href="#cb33-183" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the maximum heat treatment value (if it's unique)</span></span>
<span id="cb33-184"><a href="#cb33-184" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(unique_max_heat_treatment) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb33-185"><a href="#cb33-185" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Max Treatment:"</span>, unique_max_heat_treatment, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-186"><a href="#cb33-186" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-187"><a href="#cb33-187" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-188"><a href="#cb33-188" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate mean germination percentage for each heat treatment</span></span>
<span id="cb33-189"><a href="#cb33-189" aria-hidden="true" tabindex="-1"></a>  mean_germination <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb33-190"><a href="#cb33-190" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(species, population, heat_treatment) <span class="sc">%&gt;%</span></span>
<span id="cb33-191"><a href="#cb33-191" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean_gp =</span> <span class="fu">mean</span>(gp_standardized))</span>
<span id="cb33-192"><a href="#cb33-192" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-193"><a href="#cb33-193" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot mean germination percentage</span></span>
<span id="cb33-194"><a href="#cb33-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(mean_germination<span class="sc">$</span>heat_treatment, mean_germination<span class="sc">$</span>mean_gp, </span>
<span id="cb33-195"><a href="#cb33-195" aria-hidden="true" tabindex="-1"></a>       <span class="at">type =</span> <span class="st">"o"</span>, </span>
<span id="cb33-196"><a href="#cb33-196" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Heat Treatment"</span>, </span>
<span id="cb33-197"><a href="#cb33-197" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Mean Germination Percentage"</span>,</span>
<span id="cb33-198"><a href="#cb33-198" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Mean Germination Percentage vs. Heat Treatment for Population:"</span>, population, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Max Treatment:"</span>, unique_max_heat_treatment))</span>
<span id="cb33-199"><a href="#cb33-199" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-200"><a href="#cb33-200" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Customize x-axis to split by 5 degrees</span></span>
<span id="cb33-201"><a href="#cb33-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(mean_germination<span class="sc">$</span>heat_treatment), <span class="at">by =</span> <span class="dv">5</span>))</span>
<span id="cb33-202"><a href="#cb33-202" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-203"><a href="#cb33-203" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Allow user to select peak interactively</span></span>
<span id="cb33-204"><a href="#cb33-204" aria-hidden="true" tabindex="-1"></a>  peak <span class="ot">&lt;-</span> <span class="fu">readline</span>(<span class="at">prompt =</span> <span class="st">"Enter peak (y/n): "</span>)</span>
<span id="cb33-205"><a href="#cb33-205" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-206"><a href="#cb33-206" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">tolower</span>(peak) <span class="sc">==</span> <span class="st">"y"</span>) {</span>
<span id="cb33-207"><a href="#cb33-207" aria-hidden="true" tabindex="-1"></a>    peak_value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">readline</span>(<span class="at">prompt =</span> <span class="st">"Enter peak value: "</span>))</span>
<span id="cb33-208"><a href="#cb33-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-209"><a href="#cb33-209" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data based on peak heat treatment</span></span>
<span id="cb33-210"><a href="#cb33-210" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>heat_treatment <span class="sc">&lt;=</span> peak_value, ]</span>
<span id="cb33-211"><a href="#cb33-211" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(filtered_data)</span>
<span id="cb33-212"><a href="#cb33-212" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb33-213"><a href="#cb33-213" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If peak is not selected, use the original max_heat_treatment value for filtering</span></span>
<span id="cb33-214"><a href="#cb33-214" aria-hidden="true" tabindex="-1"></a>    max_heat_treatment <span class="ot">&lt;-</span> <span class="fu">max</span>(max_heat_treatment)</span>
<span id="cb33-215"><a href="#cb33-215" aria-hidden="true" tabindex="-1"></a>    filtered_data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>heat_treatment <span class="sc">&lt;=</span> max_heat_treatment, ]</span>
<span id="cb33-216"><a href="#cb33-216" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(filtered_data)</span>
<span id="cb33-217"><a href="#cb33-217" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-218"><a href="#cb33-218" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-219"><a href="#cb33-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-220"><a href="#cb33-220" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into separate data frames for each population of Cistus salviifolius</span></span>
<span id="cb33-221"><a href="#cb33-221" aria-hidden="true" tabindex="-1"></a>csapop_split <span class="ot">&lt;-</span> <span class="fu">split</span>(data[data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"CSA"</span>, ], data[data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"CSA"</span>, ]<span class="sc">$</span>population)</span>
<span id="cb33-222"><a href="#cb33-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-223"><a href="#cb33-223" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into separate data frames for each population of Cistus albidus</span></span>
<span id="cb33-224"><a href="#cb33-224" aria-hidden="true" tabindex="-1"></a>calpop_split <span class="ot">&lt;-</span> <span class="fu">split</span>(data[data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"CAL"</span>, ], data[data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"CAL"</span>, ]<span class="sc">$</span>population)</span>
<span id="cb33-225"><a href="#cb33-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-226"><a href="#cb33-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-227"><a href="#cb33-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE,fig.show='hide',results='hide'}</span></span>
<span id="cb33-228"><a href="#cb33-228" aria-hidden="true" tabindex="-1"></a><span class="co"># select peak CSA</span></span>
<span id="cb33-229"><a href="#cb33-229" aria-hidden="true" tabindex="-1"></a><span class="co">#pass through population plots one by one</span></span>
<span id="cb33-230"><a href="#cb33-230" aria-hidden="true" tabindex="-1"></a><span class="co">#approve or manually set peak heat</span></span>
<span id="cb33-231"><a href="#cb33-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-232"><a href="#cb33-232" aria-hidden="true" tabindex="-1"></a><span class="co">#csa 3 change to 120 ;csa 10 to 100</span></span>
<span id="cb33-233"><a href="#cb33-233" aria-hidden="true" tabindex="-1"></a>csa_populations <span class="ot">&lt;-</span> <span class="fu">Map</span>(select_peak_and_filter, csapop_split, <span class="fu">names</span>(csapop_split), <span class="fu">lapply</span>(csapop_split, <span class="cf">function</span>(data) data<span class="sc">$</span>max_heat_treatment))</span>
<span id="cb33-234"><a href="#cb33-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-235"><a href="#cb33-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-236"><a href="#cb33-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-237"><a href="#cb33-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-238"><a href="#cb33-238" aria-hidden="true" tabindex="-1"></a><span class="al">![](csa_pop1_peak.png)</span></span>
<span id="cb33-239"><a href="#cb33-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-240"><a href="#cb33-240" aria-hidden="true" tabindex="-1"></a>Population: 1</span>
<span id="cb33-241"><a href="#cb33-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-242"><a href="#cb33-242" aria-hidden="true" tabindex="-1"></a>Max Treatment: 95</span>
<span id="cb33-243"><a href="#cb33-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-244"><a href="#cb33-244" aria-hidden="true" tabindex="-1"></a>Enter peak (y/n):</span>
<span id="cb33-245"><a href="#cb33-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-246"><a href="#cb33-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE,fig.show='hide',results='hide'}</span></span>
<span id="cb33-247"><a href="#cb33-247" aria-hidden="true" tabindex="-1"></a><span class="co"># select peak CAL</span></span>
<span id="cb33-248"><a href="#cb33-248" aria-hidden="true" tabindex="-1"></a><span class="co">#pass through population plots one by one</span></span>
<span id="cb33-249"><a href="#cb33-249" aria-hidden="true" tabindex="-1"></a><span class="co">#approve or manually set peak heat</span></span>
<span id="cb33-250"><a href="#cb33-250" aria-hidden="true" tabindex="-1"></a><span class="co">#cal 3 change to 95 ;cal 8 to 90; cal 11 to 95; cal 13 to 90; cal 15 to 105 \# cal 18 to 90; cal 19 to 85; cal 20 to 90</span></span>
<span id="cb33-251"><a href="#cb33-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-252"><a href="#cb33-252" aria-hidden="true" tabindex="-1"></a>cal_populations <span class="ot">&lt;-</span> <span class="fu">Map</span>(select_peak_and_filter, calpop_split, <span class="fu">names</span>(calpop_split), <span class="fu">lapply</span>(calpop_split, <span class="cf">function</span>(data) data<span class="sc">$</span>max_heat_treatment))</span>
<span id="cb33-253"><a href="#cb33-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-254"><a href="#cb33-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-255"><a href="#cb33-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-256"><a href="#cb33-256" aria-hidden="true" tabindex="-1"></a><span class="al">![](cal1_peak.png)</span></span>
<span id="cb33-257"><a href="#cb33-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-258"><a href="#cb33-258" aria-hidden="true" tabindex="-1"></a>Population: 1</span>
<span id="cb33-259"><a href="#cb33-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-260"><a href="#cb33-260" aria-hidden="true" tabindex="-1"></a>Max Treatment: 80</span>
<span id="cb33-261"><a href="#cb33-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-262"><a href="#cb33-262" aria-hidden="true" tabindex="-1"></a>Enter peak (y/n):</span>
<span id="cb33-263"><a href="#cb33-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-264"><a href="#cb33-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-265"><a href="#cb33-265" aria-hidden="true" tabindex="-1"></a><span class="co">#Save as dataframes</span></span>
<span id="cb33-266"><a href="#cb33-266" aria-hidden="true" tabindex="-1"></a>combined_csa <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(csa_populations, <span class="at">.id =</span> <span class="st">"population_id"</span>) </span>
<span id="cb33-267"><a href="#cb33-267" aria-hidden="true" tabindex="-1"></a>combined_cal <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cal_populations, <span class="at">.id =</span> <span class="st">"population_id"</span>)</span>
<span id="cb33-268"><a href="#cb33-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-269"><a href="#cb33-269" aria-hidden="true" tabindex="-1"></a><span class="co">#Save filtered data as RDS file</span></span>
<span id="cb33-270"><a href="#cb33-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-271"><a href="#cb33-271" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(combined_csa, <span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/filtered_csa_data.rds"</span>)</span>
<span id="cb33-272"><a href="#cb33-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-273"><a href="#cb33-273" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(combined_cal, <span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/filtered_cal_data.rds"</span>)</span>
<span id="cb33-274"><a href="#cb33-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-275"><a href="#cb33-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-276"><a href="#cb33-276" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dose response curves</span></span>
<span id="cb33-277"><a href="#cb33-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-278"><a href="#cb33-278" aria-hidden="true" tabindex="-1"></a>We used Dose response curves to predict the heat dose required for the response of seeds to reach the 20th, 30th, 40th, 50th and 60th percentiles of germination, with 95 % confidence intervals.</span>
<span id="cb33-279"><a href="#cb33-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-280"><a href="#cb33-280" aria-hidden="true" tabindex="-1"></a>To do so, we fitted either a four-parameter non-linear Weibull or a four-parameter log-logistic function, chosen with the myselect function, according to the Akaike information criterion (AIC), log likelihood estimations and lack-of- fit test. Four parameters were necessary as the lower limits were not fixed at 0 after standardizing the curve for non-dormant seeds (there were a range of low heat treatments that likely caused mortality in non-dormant seeds, but didn't stimulate germination in dormant ones).</span>
<span id="cb33-281"><a href="#cb33-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-282"><a href="#cb33-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-283"><a href="#cb33-283" aria-hidden="true" tabindex="-1"></a><span class="co">#upload filtered data-----</span></span>
<span id="cb33-284"><a href="#cb33-284" aria-hidden="true" tabindex="-1"></a>csa <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/filtered_csa_data.rds"</span>)</span>
<span id="cb33-285"><a href="#cb33-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-286"><a href="#cb33-286" aria-hidden="true" tabindex="-1"></a>cal <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/filtered_cal_data.rds"</span>)</span>
<span id="cb33-287"><a href="#cb33-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-288"><a href="#cb33-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-289"><a href="#cb33-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE,fig.show='hide',results='hide'}</span></span>
<span id="cb33-290"><a href="#cb33-290" aria-hidden="true" tabindex="-1"></a><span class="co">#unfortunately mselect doesn't work when applied to a list or used in a function,</span></span>
<span id="cb33-291"><a href="#cb33-291" aria-hidden="true" tabindex="-1"></a><span class="co">#so we have to apply drm and mselect functions manually</span></span>
<span id="cb33-292"><a href="#cb33-292" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 1: models drm()</span></span>
<span id="cb33-293"><a href="#cb33-293" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 2: mselect (model) to select most parsimonous model type</span></span>
<span id="cb33-294"><a href="#cb33-294" aria-hidden="true" tabindex="-1"></a><span class="co">#Step 3: rerun model with selected model type</span></span>
<span id="cb33-295"><a href="#cb33-295" aria-hidden="true" tabindex="-1"></a><span class="co"># germination decimal format used in order to later use effective dose (ED function) type 'absolute'</span></span>
<span id="cb33-296"><a href="#cb33-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-297"><a href="#cb33-297" aria-hidden="true" tabindex="-1"></a><span class="do">### Models----</span></span>
<span id="cb33-298"><a href="#cb33-298" aria-hidden="true" tabindex="-1"></a><span class="co"># (correct model already selected using mselect function - see section below)</span></span>
<span id="cb33-299"><a href="#cb33-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-300"><a href="#cb33-300" aria-hidden="true" tabindex="-1"></a>model_csa_1 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"1"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-301"><a href="#cb33-301" aria-hidden="true" tabindex="-1"></a>model_csa_2 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"2"</span>,], <span class="at">fct =</span> <span class="fu">W2.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-302"><a href="#cb33-302" aria-hidden="true" tabindex="-1"></a>model_csa_3 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"3"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-303"><a href="#cb33-303" aria-hidden="true" tabindex="-1"></a>model_csa_4 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"4"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-304"><a href="#cb33-304" aria-hidden="true" tabindex="-1"></a>model_csa_5 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"5"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-305"><a href="#cb33-305" aria-hidden="true" tabindex="-1"></a>model_csa_6 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"6"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-306"><a href="#cb33-306" aria-hidden="true" tabindex="-1"></a>model_csa_7 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"7"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-307"><a href="#cb33-307" aria-hidden="true" tabindex="-1"></a>model_csa_8 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"8"</span>,], <span class="at">fct =</span> <span class="fu">W2.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-308"><a href="#cb33-308" aria-hidden="true" tabindex="-1"></a>model_csa_9 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"9"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-309"><a href="#cb33-309" aria-hidden="true" tabindex="-1"></a>model_csa_10 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"10"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-310"><a href="#cb33-310" aria-hidden="true" tabindex="-1"></a>model_csa_11 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> csa[csa<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"11"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-311"><a href="#cb33-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-312"><a href="#cb33-312" aria-hidden="true" tabindex="-1"></a>model_cal_1 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"1"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-313"><a href="#cb33-313" aria-hidden="true" tabindex="-1"></a>model_cal_2 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"2"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-314"><a href="#cb33-314" aria-hidden="true" tabindex="-1"></a>model_cal_3 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"3"</span>,], <span class="at">fct =</span> <span class="fu">W2.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-315"><a href="#cb33-315" aria-hidden="true" tabindex="-1"></a>model_cal_4 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"4"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-316"><a href="#cb33-316" aria-hidden="true" tabindex="-1"></a>model_cal_5 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"5"</span>,], <span class="at">fct =</span> <span class="fu">LL.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-317"><a href="#cb33-317" aria-hidden="true" tabindex="-1"></a>model_cal_6 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"6"</span>,], <span class="at">fct =</span> <span class="fu">LL.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-318"><a href="#cb33-318" aria-hidden="true" tabindex="-1"></a>model_cal_7 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"7"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-319"><a href="#cb33-319" aria-hidden="true" tabindex="-1"></a>model_cal_8 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"8"</span>,], <span class="at">fct =</span> <span class="fu">W2.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-320"><a href="#cb33-320" aria-hidden="true" tabindex="-1"></a>model_cal_9 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"9"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-321"><a href="#cb33-321" aria-hidden="true" tabindex="-1"></a>model_cal_10 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"10"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-322"><a href="#cb33-322" aria-hidden="true" tabindex="-1"></a>model_cal_11 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"11"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-323"><a href="#cb33-323" aria-hidden="true" tabindex="-1"></a>model_cal_12 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"12"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-324"><a href="#cb33-324" aria-hidden="true" tabindex="-1"></a>model_cal_13 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"13"</span>,], <span class="at">fct =</span> <span class="fu">LL.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-325"><a href="#cb33-325" aria-hidden="true" tabindex="-1"></a>model_cal_14 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"14"</span>,], <span class="at">fct =</span> <span class="fu">LL.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-326"><a href="#cb33-326" aria-hidden="true" tabindex="-1"></a>model_cal_15 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"15"</span>,], <span class="at">fct =</span> <span class="fu">W2.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-327"><a href="#cb33-327" aria-hidden="true" tabindex="-1"></a>model_cal_16 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"16"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-328"><a href="#cb33-328" aria-hidden="true" tabindex="-1"></a>model_cal_17 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"17"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-329"><a href="#cb33-329" aria-hidden="true" tabindex="-1"></a>model_cal_18 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"18"</span>,], <span class="at">fct =</span> <span class="fu">LL.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-330"><a href="#cb33-330" aria-hidden="true" tabindex="-1"></a>model_cal_19 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"19"</span>,], <span class="at">fct =</span> <span class="fu">W2.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-331"><a href="#cb33-331" aria-hidden="true" tabindex="-1"></a>model_cal_20 <span class="ot">&lt;-</span> <span class="fu">drm</span>(gd_standardized <span class="sc">~</span> heat_treatment, <span class="at">data =</span> cal[cal<span class="sc">$</span>population <span class="sc">==</span> <span class="st">"20"</span>,], <span class="at">fct =</span> <span class="fu">W1.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Slope"</span>, <span class="st">"Lower Limit"</span>, <span class="st">"Upper Limit"</span>, <span class="st">"ED50"</span>)))</span>
<span id="cb33-332"><a href="#cb33-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-333"><a href="#cb33-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-334"><a href="#cb33-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE,fig.show='hide',results='hide'}</span></span>
<span id="cb33-335"><a href="#cb33-335" aria-hidden="true" tabindex="-1"></a><span class="do">### MySelect ------</span></span>
<span id="cb33-336"><a href="#cb33-336" aria-hidden="true" tabindex="-1"></a><span class="co"># four parameter log logistic curve (LL.4 or LL2.4) or four parameter Weibull curve (W1.4 or W2.4)</span></span>
<span id="cb33-337"><a href="#cb33-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-338"><a href="#cb33-338" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_1, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-339"><a href="#cb33-339" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_2, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-340"><a href="#cb33-340" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_3, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-341"><a href="#cb33-341" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_4, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-342"><a href="#cb33-342" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_5, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-343"><a href="#cb33-343" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_6, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-344"><a href="#cb33-344" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_7, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-345"><a href="#cb33-345" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_8, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-346"><a href="#cb33-346" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_9, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-347"><a href="#cb33-347" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_10, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-348"><a href="#cb33-348" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_csa_11, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-349"><a href="#cb33-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-350"><a href="#cb33-350" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_1, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-351"><a href="#cb33-351" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_2, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-352"><a href="#cb33-352" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_3, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-353"><a href="#cb33-353" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_4, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-354"><a href="#cb33-354" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_5, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-355"><a href="#cb33-355" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_6, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-356"><a href="#cb33-356" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_7, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-357"><a href="#cb33-357" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_8, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-358"><a href="#cb33-358" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_9, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-359"><a href="#cb33-359" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_10, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-360"><a href="#cb33-360" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_11, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-361"><a href="#cb33-361" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_12, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-362"><a href="#cb33-362" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_13, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-363"><a href="#cb33-363" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_14, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-364"><a href="#cb33-364" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_15, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-365"><a href="#cb33-365" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_16, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-366"><a href="#cb33-366" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_17, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-367"><a href="#cb33-367" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_18, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-368"><a href="#cb33-368" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_19, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-369"><a href="#cb33-369" aria-hidden="true" tabindex="-1"></a><span class="fu">mselect</span>(model_cal_20, <span class="at">fctList =</span> <span class="fu">list</span>(<span class="fu">LL.4</span>(), <span class="fu">W1.4</span>(), <span class="fu">W2.4</span>(), <span class="fu">LL2.4</span>()), <span class="at">linreg =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-370"><a href="#cb33-370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-371"><a href="#cb33-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-372"><a href="#cb33-372" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE,fig.show='hide',results='hide'}</span></span>
<span id="cb33-373"><a href="#cb33-373" aria-hidden="true" tabindex="-1"></a><span class="co"># model list</span></span>
<span id="cb33-374"><a href="#cb33-374" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb33-375"><a href="#cb33-375" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_csa_1 =</span> model_csa_1, <span class="at">model_csa_2 =</span> model_csa_2, <span class="at">model_csa_3 =</span> model_csa_3, <span class="at">model_csa_4 =</span> model_csa_4, <span class="at">model_csa_5 =</span> model_csa_5, <span class="at">model_csa_6 =</span> model_csa_6,</span>
<span id="cb33-376"><a href="#cb33-376" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_csa_7 =</span> model_csa_7, <span class="at">model_csa_8 =</span> model_csa_8, <span class="at">model_csa_9 =</span> model_csa_9, <span class="at">model_csa_10 =</span> model_csa_10, <span class="at">model_csa_11 =</span> model_csa_11,</span>
<span id="cb33-377"><a href="#cb33-377" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_cal_1 =</span> model_cal_1, <span class="at">model_cal_2 =</span> model_cal_2, <span class="at">model_cal_3 =</span> model_cal_3, <span class="at">model_cal_4 =</span> model_cal_4, <span class="at">model_cal_5 =</span> model_cal_5, <span class="at">model_cal_6 =</span> model_cal_6, <span class="at">model_cal_7 =</span> model_cal_7,</span>
<span id="cb33-378"><a href="#cb33-378" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_cal_8 =</span> model_cal_8, <span class="at">model_cal_9 =</span> model_cal_9, <span class="at">model_cal_10 =</span> model_cal_10, <span class="at">model_cal_11 =</span> model_cal_11, <span class="at">model_cal_12 =</span> model_cal_12, <span class="at">model_cal_13 =</span> model_cal_13,</span>
<span id="cb33-379"><a href="#cb33-379" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_cal_14 =</span> model_cal_14, <span class="at">model_cal_15 =</span> model_cal_15, <span class="at">model_cal_16 =</span> model_cal_16, <span class="at">model_cal_17 =</span> model_cal_17, <span class="at">model_cal_18 =</span> model_cal_18, <span class="at">model_cal_19 =</span> model_cal_19,</span>
<span id="cb33-380"><a href="#cb33-380" aria-hidden="true" tabindex="-1"></a>  <span class="at">model_cal_20 =</span> model_cal_20</span>
<span id="cb33-381"><a href="#cb33-381" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-382"><a href="#cb33-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-383"><a href="#cb33-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-384"><a href="#cb33-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE,fig.show='hide',results='hide'}</span></span>
<span id="cb33-385"><a href="#cb33-385" aria-hidden="true" tabindex="-1"></a><span class="co">#Show model plots </span></span>
<span id="cb33-386"><a href="#cb33-386" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each model in the list and plot them</span></span>
<span id="cb33-387"><a href="#cb33-387" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (model_name <span class="cf">in</span> <span class="fu">names</span>(models)) {</span>
<span id="cb33-388"><a href="#cb33-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(models[[model_name]], <span class="at">main =</span> model_name)</span>
<span id="cb33-389"><a href="#cb33-389" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Wait for the plot to be closed</span></span>
<span id="cb33-390"><a href="#cb33-390" aria-hidden="true" tabindex="-1"></a>  input <span class="ot">&lt;-</span> <span class="fu">readline</span>(<span class="at">prompt =</span> <span class="st">"Press Enter to continue..."</span>)</span>
<span id="cb33-391"><a href="#cb33-391" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-392"><a href="#cb33-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-393"><a href="#cb33-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-394"><a href="#cb33-394" aria-hidden="true" tabindex="-1"></a><span class="al">![](drc_csa1.png)</span></span>
<span id="cb33-395"><a href="#cb33-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-396"><a href="#cb33-396" aria-hidden="true" tabindex="-1"></a><span class="al">![](drc_cal1.png)</span></span>
<span id="cb33-397"><a href="#cb33-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-398"><a href="#cb33-398" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effective dose 'Lower heat threshold'</span></span>
<span id="cb33-399"><a href="#cb33-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-400"><a href="#cb33-400" aria-hidden="true" tabindex="-1"></a>From these models, the effective dose (ED) function was used to predict the effective heat doses, or 'lower heat thresholds' at which 20--60 % dormancy release occurs for each population.</span>
<span id="cb33-401"><a href="#cb33-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-402"><a href="#cb33-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE,fig.show='hide',results='hide'}</span></span>
<span id="cb33-403"><a href="#cb33-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-404"><a href="#cb33-404" aria-hidden="true" tabindex="-1"></a><span class="co"># function for 'ed'</span></span>
<span id="cb33-405"><a href="#cb33-405" aria-hidden="true" tabindex="-1"></a>ed <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb33-406"><a href="#cb33-406" aria-hidden="true" tabindex="-1"></a><span class="fu">ED</span>(x, <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>), <span class="at">type =</span> <span class="st">"absolute"</span>, <span class="at">interval =</span> <span class="st">"delta"</span>)</span>
<span id="cb33-407"><a href="#cb33-407" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-408"><a href="#cb33-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-409"><a href="#cb33-409" aria-hidden="true" tabindex="-1"></a><span class="co"># apply ed function to the list of all models</span></span>
<span id="cb33-410"><a href="#cb33-410" aria-hidden="true" tabindex="-1"></a>ed.all <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models, <span class="at">FUN =</span> ed, <span class="at">simplify =</span> <span class="cn">FALSE</span>, <span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-411"><a href="#cb33-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-412"><a href="#cb33-412" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to dataframe</span></span>
<span id="cb33-413"><a href="#cb33-413" aria-hidden="true" tabindex="-1"></a>ed.df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind.data.frame, ed.all)</span>
<span id="cb33-414"><a href="#cb33-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-415"><a href="#cb33-415" aria-hidden="true" tabindex="-1"></a><span class="co"># export to csv</span></span>
<span id="cb33-416"><a href="#cb33-416" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ed.df, <span class="at">file =</span> <span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/ed_all2.csv"</span>)</span>
<span id="cb33-417"><a href="#cb33-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-418"><a href="#cb33-418" aria-hidden="true" tabindex="-1"></a><span class="co"># note: in csv model name and dormancy release level are combined in first column.</span></span>
<span id="cb33-419"><a href="#cb33-419" aria-hidden="true" tabindex="-1"></a><span class="co"># reformatted csv loaded in next section</span></span>
<span id="cb33-420"><a href="#cb33-420" aria-hidden="true" tabindex="-1"></a><span class="co"># e:1:0.2 = 0.2 or 20% dormancy release</span></span>
<span id="cb33-421"><a href="#cb33-421" aria-hidden="true" tabindex="-1"></a><span class="co"># e:1:0.3 = 30%</span></span>
<span id="cb33-422"><a href="#cb33-422" aria-hidden="true" tabindex="-1"></a><span class="co"># e:1:0.4 = 40%</span></span>
<span id="cb33-423"><a href="#cb33-423" aria-hidden="true" tabindex="-1"></a><span class="co"># e:1:0.5 = 50%</span></span>
<span id="cb33-424"><a href="#cb33-424" aria-hidden="true" tabindex="-1"></a><span class="co"># e:1:0.6 = 60%</span></span>
<span id="cb33-425"><a href="#cb33-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-426"><a href="#cb33-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-427"><a href="#cb33-427" aria-hidden="true" tabindex="-1"></a><span class="fu">## Combine thresholds with climate data</span></span>
<span id="cb33-428"><a href="#cb33-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-429"><a href="#cb33-429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-430"><a href="#cb33-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-431"><a href="#cb33-431" aria-hidden="true" tabindex="-1"></a><span class="co"># reformatted effective dose csv</span></span>
<span id="cb33-432"><a href="#cb33-432" aria-hidden="true" tabindex="-1"></a>ed.estimate <span class="ot">&lt;-</span> <span class="fu">read.csv</span>((<span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/ed.all.csv"</span>), <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb33-433"><a href="#cb33-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-434"><a href="#cb33-434" aria-hidden="true" tabindex="-1"></a><span class="co"># site characteristics, climate, fire, and seed mass variables</span></span>
<span id="cb33-435"><a href="#cb33-435" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">read.csv</span>((<span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/site_data.csv"</span>), <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb33-436"><a href="#cb33-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-437"><a href="#cb33-437" aria-hidden="true" tabindex="-1"></a><span class="co">#merge</span></span>
<span id="cb33-438"><a href="#cb33-438" aria-hidden="true" tabindex="-1"></a>ed_climate <span class="ot">&lt;-</span> <span class="fu">merge</span>(sites, ed.estimate, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"species"</span>, <span class="st">"pop"</span>))</span>
<span id="cb33-439"><a href="#cb33-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-440"><a href="#cb33-440" aria-hidden="true" tabindex="-1"></a><span class="co"># clean data</span></span>
<span id="cb33-441"><a href="#cb33-441" aria-hidden="true" tabindex="-1"></a>ed_climate <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(ed_climate)</span>
<span id="cb33-442"><a href="#cb33-442" aria-hidden="true" tabindex="-1"></a>ed_climate<span class="sc">$</span>Estimate <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(ed_climate<span class="sc">$</span>Estimate)</span>
<span id="cb33-443"><a href="#cb33-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-444"><a href="#cb33-444" aria-hidden="true" tabindex="-1"></a><span class="co"># export to csv</span></span>
<span id="cb33-445"><a href="#cb33-445" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(ed_climate, file = "input/ed_climate.csv")</span></span>
<span id="cb33-446"><a href="#cb33-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-447"><a href="#cb33-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-448"><a href="#cb33-448" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regression variable selection</span></span>
<span id="cb33-449"><a href="#cb33-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-450"><a href="#cb33-450" aria-hidden="true" tabindex="-1"></a>To test to what extent heat thresholds of each population were related to their local climate, a linear regression model was fitted to lower heat threshold estimates. Species, dormancy release level, latitude, bioclimatic, fire and seed mass variables were added to the model as fixed effects. We used a stepwise approach to select the most parsimonious model; each step was assessed with analysis of variance (ANOVA) test and AIC.</span>
<span id="cb33-451"><a href="#cb33-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-452"><a href="#cb33-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-453"><a href="#cb33-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-454"><a href="#cb33-454" aria-hidden="true" tabindex="-1"></a><span class="co">#upload merged data</span></span>
<span id="cb33-455"><a href="#cb33-455" aria-hidden="true" tabindex="-1"></a>ed_climate <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"/Users/maya/Dropbox/Maya Thesis/Seed Thermal Thresholds/seed_thresholds_R/input/ed_climate.csv"</span>)</span>
<span id="cb33-456"><a href="#cb33-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-457"><a href="#cb33-457" aria-hidden="true" tabindex="-1"></a><span class="co"># Model Selection</span></span>
<span id="cb33-458"><a href="#cb33-458" aria-hidden="true" tabindex="-1"></a><span class="co"># add variables into model in order of contribution to variance</span></span>
<span id="cb33-459"><a href="#cb33-459" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to null model using ANOVA</span></span>
<span id="cb33-460"><a href="#cb33-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-461"><a href="#cb33-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-462"><a href="#cb33-462" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a null model</span></span>
<span id="cb33-463"><a href="#cb33-463" aria-hidden="true" tabindex="-1"></a>null_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Estimate <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> ed_climate)</span>
<span id="cb33-464"><a href="#cb33-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-465"><a href="#cb33-465" aria-hidden="true" tabindex="-1"></a><span class="co"># List of variables</span></span>
<span id="cb33-466"><a href="#cb33-466" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dormancy_release"</span>, <span class="st">"species"</span>, <span class="st">"BIO_05"</span>, <span class="st">"BIO_01"</span>, <span class="st">"elevation"</span>, <span class="st">"seed_mass"</span>, <span class="st">"BIO_12"</span>, <span class="st">"aridity_index"</span>, <span class="st">"burned_area_percent"</span>, <span class="st">"annual_number_fires"</span>, <span class="st">"lat"</span>)</span>
<span id="cb33-467"><a href="#cb33-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-468"><a href="#cb33-468" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA for each variable</span></span>
<span id="cb33-469"><a href="#cb33-469" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> variables) {</span>
<span id="cb33-470"><a href="#cb33-470" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the null model with the current variable</span></span>
<span id="cb33-471"><a href="#cb33-471" aria-hidden="true" tabindex="-1"></a>  updated_model <span class="ot">&lt;-</span> <span class="fu">update</span>(null_model, <span class="fu">reformulate</span>(var, <span class="at">response =</span> <span class="st">"Estimate"</span>), <span class="at">data =</span> ed_climate)</span>
<span id="cb33-472"><a href="#cb33-472" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-473"><a href="#cb33-473" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform ANOVA</span></span>
<span id="cb33-474"><a href="#cb33-474" aria-hidden="true" tabindex="-1"></a>  anova_result <span class="ot">&lt;-</span> <span class="fu">anova</span>(null_model, updated_model)</span>
<span id="cb33-475"><a href="#cb33-475" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-476"><a href="#cb33-476" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract p-value</span></span>
<span id="cb33-477"><a href="#cb33-477" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> anova_result[<span class="dv">2</span>, <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb33-478"><a href="#cb33-478" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-479"><a href="#cb33-479" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display results</span></span>
<span id="cb33-480"><a href="#cb33-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Variable:"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-481"><a href="#cb33-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(updated_model), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-482"><a href="#cb33-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">format</span>(p_value, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-483"><a href="#cb33-483" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>) {</span>
<span id="cb33-484"><a href="#cb33-484" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"***</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-485"><a href="#cb33-485" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.01</span>) {</span>
<span id="cb33-486"><a href="#cb33-486" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"**</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-487"><a href="#cb33-487" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb33-488"><a href="#cb33-488" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"*</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-489"><a href="#cb33-489" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb33-490"><a href="#cb33-490" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"ns</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-491"><a href="#cb33-491" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-492"><a href="#cb33-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-493"><a href="#cb33-493" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-494"><a href="#cb33-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-495"><a href="#cb33-495" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-496"><a href="#cb33-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-497"><a href="#cb33-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE,fig.show='hide',results='hide'}</span></span>
<span id="cb33-498"><a href="#cb33-498" aria-hidden="true" tabindex="-1"></a><span class="co">#REPEAT until variables no longer contribute to variance</span></span>
<span id="cb33-499"><a href="#cb33-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-500"><a href="#cb33-500" aria-hidden="true" tabindex="-1"></a><span class="co">#Iteration 2</span></span>
<span id="cb33-501"><a href="#cb33-501" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a null model</span></span>
<span id="cb33-502"><a href="#cb33-502" aria-hidden="true" tabindex="-1"></a>null_model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Estimate <span class="sc">~</span> dormancy_release, <span class="at">data =</span> ed_climate)</span>
<span id="cb33-503"><a href="#cb33-503" aria-hidden="true" tabindex="-1"></a>AIC_null_2 <span class="ot">&lt;-</span> <span class="fu">AIC</span>(null_model_2)</span>
<span id="cb33-504"><a href="#cb33-504" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Null model AIC:"</span>, AIC_null_2, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-505"><a href="#cb33-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-506"><a href="#cb33-506" aria-hidden="true" tabindex="-1"></a><span class="co"># List of variables</span></span>
<span id="cb33-507"><a href="#cb33-507" aria-hidden="true" tabindex="-1"></a>variables_2 <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"species"</span>, <span class="st">"BIO_05"</span>, <span class="st">"BIO_01"</span>, <span class="st">"elevation"</span>, <span class="st">"seed_mass"</span>, <span class="st">"BIO_12"</span>, <span class="st">"aridity_index"</span>, <span class="st">"burned_area_percent"</span>, <span class="st">"annual_number_fires"</span>, <span class="st">"lat"</span>)</span>
<span id="cb33-508"><a href="#cb33-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-509"><a href="#cb33-509" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA for each variable</span></span>
<span id="cb33-510"><a href="#cb33-510" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> variables_2) {</span>
<span id="cb33-511"><a href="#cb33-511" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the null model with the current variable</span></span>
<span id="cb33-512"><a href="#cb33-512" aria-hidden="true" tabindex="-1"></a>  updated_model_2 <span class="ot">&lt;-</span> <span class="fu">update</span>(null_model_2, <span class="fu">reformulate</span>(<span class="fu">c</span>(<span class="st">"dormancy_release"</span>, var), <span class="at">response =</span> <span class="st">"Estimate"</span>), <span class="at">data =</span> ed_climate)</span>
<span id="cb33-513"><a href="#cb33-513" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-514"><a href="#cb33-514" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform ANOVA</span></span>
<span id="cb33-515"><a href="#cb33-515" aria-hidden="true" tabindex="-1"></a>  anova_result_2 <span class="ot">&lt;-</span> <span class="fu">anova</span>(null_model_2, updated_model_2)</span>
<span id="cb33-516"><a href="#cb33-516" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-517"><a href="#cb33-517" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract p-value</span></span>
<span id="cb33-518"><a href="#cb33-518" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> anova_result_2[<span class="dv">2</span>, <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb33-519"><a href="#cb33-519" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-520"><a href="#cb33-520" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display results</span></span>
<span id="cb33-521"><a href="#cb33-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Variable:"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-522"><a href="#cb33-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(updated_model_2), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-523"><a href="#cb33-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">format</span>(p_value, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-524"><a href="#cb33-524" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>) {</span>
<span id="cb33-525"><a href="#cb33-525" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"***</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-526"><a href="#cb33-526" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.01</span>) {</span>
<span id="cb33-527"><a href="#cb33-527" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"**</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-528"><a href="#cb33-528" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb33-529"><a href="#cb33-529" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"*</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-530"><a href="#cb33-530" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb33-531"><a href="#cb33-531" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"ns</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-532"><a href="#cb33-532" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-533"><a href="#cb33-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-534"><a href="#cb33-534" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-535"><a href="#cb33-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-536"><a href="#cb33-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-537"><a href="#cb33-537" aria-hidden="true" tabindex="-1"></a><span class="co">#Iteration 3</span></span>
<span id="cb33-538"><a href="#cb33-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-539"><a href="#cb33-539" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a null model</span></span>
<span id="cb33-540"><a href="#cb33-540" aria-hidden="true" tabindex="-1"></a>null_model_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Estimate <span class="sc">~</span> dormancy_release <span class="sc">+</span> species, <span class="at">data =</span> ed_climate)</span>
<span id="cb33-541"><a href="#cb33-541" aria-hidden="true" tabindex="-1"></a>AIC_null_3 <span class="ot">&lt;-</span> <span class="fu">AIC</span>(null_model_3)</span>
<span id="cb33-542"><a href="#cb33-542" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Null model AIC:"</span>, AIC_null_3, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-543"><a href="#cb33-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-544"><a href="#cb33-544" aria-hidden="true" tabindex="-1"></a><span class="co"># List of variables</span></span>
<span id="cb33-545"><a href="#cb33-545" aria-hidden="true" tabindex="-1"></a>variables_3 <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"BIO_05"</span>, <span class="st">"BIO_01"</span>, <span class="st">"elevation"</span>, <span class="st">"seed_mass"</span>, <span class="st">"BIO_12"</span>, <span class="st">"aridity_index"</span>, <span class="st">"burned_area_percent"</span>, <span class="st">"annual_number_fires"</span>, <span class="st">"lat"</span>)</span>
<span id="cb33-546"><a href="#cb33-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-547"><a href="#cb33-547" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA for each variable</span></span>
<span id="cb33-548"><a href="#cb33-548" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> variables_3) {</span>
<span id="cb33-549"><a href="#cb33-549" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the null model with the current variable</span></span>
<span id="cb33-550"><a href="#cb33-550" aria-hidden="true" tabindex="-1"></a>  updated_model_3 <span class="ot">&lt;-</span> <span class="fu">update</span>(null_model_3, <span class="fu">reformulate</span>(<span class="fu">c</span>(<span class="st">"dormancy_release"</span>, <span class="st">"species"</span>,var), <span class="at">response =</span> <span class="st">"Estimate"</span>), <span class="at">data =</span> ed_climate)</span>
<span id="cb33-551"><a href="#cb33-551" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-552"><a href="#cb33-552" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform ANOVA</span></span>
<span id="cb33-553"><a href="#cb33-553" aria-hidden="true" tabindex="-1"></a>  anova_result_3 <span class="ot">&lt;-</span> <span class="fu">anova</span>(null_model_3, updated_model_3)</span>
<span id="cb33-554"><a href="#cb33-554" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-555"><a href="#cb33-555" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract p-value</span></span>
<span id="cb33-556"><a href="#cb33-556" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> anova_result_3[<span class="fu">nrow</span>(anova_result_3), <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb33-557"><a href="#cb33-557" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-558"><a href="#cb33-558" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display results</span></span>
<span id="cb33-559"><a href="#cb33-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Variable:"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-560"><a href="#cb33-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(updated_model_3), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-561"><a href="#cb33-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">format</span>(p_value, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-562"><a href="#cb33-562" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>) {</span>
<span id="cb33-563"><a href="#cb33-563" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"***</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-564"><a href="#cb33-564" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.01</span>) {</span>
<span id="cb33-565"><a href="#cb33-565" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"**</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-566"><a href="#cb33-566" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb33-567"><a href="#cb33-567" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"*</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-568"><a href="#cb33-568" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb33-569"><a href="#cb33-569" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"ns</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-570"><a href="#cb33-570" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-571"><a href="#cb33-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-572"><a href="#cb33-572" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-573"><a href="#cb33-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-574"><a href="#cb33-574" aria-hidden="true" tabindex="-1"></a><span class="co">#Iteration 4</span></span>
<span id="cb33-575"><a href="#cb33-575" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a null model</span></span>
<span id="cb33-576"><a href="#cb33-576" aria-hidden="true" tabindex="-1"></a>null_model_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Estimate <span class="sc">~</span> dormancy_release <span class="sc">+</span> species <span class="sc">+</span>BIO_05, <span class="at">data =</span> ed_climate)</span>
<span id="cb33-577"><a href="#cb33-577" aria-hidden="true" tabindex="-1"></a>AIC_null_4 <span class="ot">&lt;-</span> <span class="fu">AIC</span>(null_model_4)</span>
<span id="cb33-578"><a href="#cb33-578" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Null model AIC:"</span>, AIC_null_4, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-579"><a href="#cb33-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-580"><a href="#cb33-580" aria-hidden="true" tabindex="-1"></a><span class="co"># List of variables</span></span>
<span id="cb33-581"><a href="#cb33-581" aria-hidden="true" tabindex="-1"></a>variables_4 <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"BIO_01"</span>, <span class="st">"elevation"</span>, <span class="st">"seed_mass"</span>, <span class="st">"BIO_12"</span>, <span class="st">"aridity_index"</span>, <span class="st">"burned_area_percent"</span>, <span class="st">"annual_number_fires"</span>, <span class="st">"lat"</span>)</span>
<span id="cb33-582"><a href="#cb33-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-583"><a href="#cb33-583" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform ANOVA for each variable</span></span>
<span id="cb33-584"><a href="#cb33-584" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> variables_4) {</span>
<span id="cb33-585"><a href="#cb33-585" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the null model with the current variable</span></span>
<span id="cb33-586"><a href="#cb33-586" aria-hidden="true" tabindex="-1"></a>  updated_model_4 <span class="ot">&lt;-</span> <span class="fu">update</span>(null_model_4, <span class="fu">reformulate</span>(<span class="fu">c</span>(<span class="st">"dormancy_release"</span>, <span class="st">"species"</span>,<span class="st">"BIO_05"</span>,var), <span class="at">response =</span> <span class="st">"Estimate"</span>), <span class="at">data =</span> ed_climate)</span>
<span id="cb33-587"><a href="#cb33-587" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-588"><a href="#cb33-588" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform ANOVA</span></span>
<span id="cb33-589"><a href="#cb33-589" aria-hidden="true" tabindex="-1"></a>  anova_result_4 <span class="ot">&lt;-</span> <span class="fu">anova</span>(null_model_4, updated_model_4)</span>
<span id="cb33-590"><a href="#cb33-590" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-591"><a href="#cb33-591" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract p-value</span></span>
<span id="cb33-592"><a href="#cb33-592" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> anova_result_4[<span class="fu">nrow</span>(anova_result_4), <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb33-593"><a href="#cb33-593" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-594"><a href="#cb33-594" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display results</span></span>
<span id="cb33-595"><a href="#cb33-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Variable:"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-596"><a href="#cb33-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"AIC:"</span>, <span class="fu">AIC</span>(updated_model_4), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-597"><a href="#cb33-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">format</span>(p_value, <span class="at">scientific =</span> <span class="cn">TRUE</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-598"><a href="#cb33-598" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.001</span>) {</span>
<span id="cb33-599"><a href="#cb33-599" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"***</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-600"><a href="#cb33-600" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.01</span>) {</span>
<span id="cb33-601"><a href="#cb33-601" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"**</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-602"><a href="#cb33-602" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb33-603"><a href="#cb33-603" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"*</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-604"><a href="#cb33-604" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb33-605"><a href="#cb33-605" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"ns</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-606"><a href="#cb33-606" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-607"><a href="#cb33-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-608"><a href="#cb33-608" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-609"><a href="#cb33-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-610"><a href="#cb33-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-611"><a href="#cb33-611" aria-hidden="true" tabindex="-1"></a><span class="fu">## Final model results</span></span>
<span id="cb33-612"><a href="#cb33-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-613"><a href="#cb33-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-614"><a href="#cb33-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-615"><a href="#cb33-615" aria-hidden="true" tabindex="-1"></a><span class="co"># linear regression with maximum temperature of warmest month (BIO_05), dormancy release %, and species as fixed factors</span></span>
<span id="cb33-616"><a href="#cb33-616" aria-hidden="true" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Estimate <span class="sc">~</span> BIO_05 <span class="sc">*</span> dormancy_release <span class="sc">+</span> BIO_05 <span class="sc">*</span> species, ed_climate)</span>
<span id="cb33-617"><a href="#cb33-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-618"><a href="#cb33-618" aria-hidden="true" tabindex="-1"></a><span class="co"># lm parameters</span></span>
<span id="cb33-619"><a href="#cb33-619" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(final_model)</span>
<span id="cb33-620"><a href="#cb33-620" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_model)</span>
<span id="cb33-621"><a href="#cb33-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-622"><a href="#cb33-622" aria-hidden="true" tabindex="-1"></a><span class="co">#residuals</span></span>
<span id="cb33-623"><a href="#cb33-623" aria-hidden="true" tabindex="-1"></a>simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> final_model, <span class="at">plot =</span> F)</span>
<span id="cb33-624"><a href="#cb33-624" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simulationOutput)</span>
<span id="cb33-625"><a href="#cb33-625" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(simulationOutput)</span>
<span id="cb33-626"><a href="#cb33-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-627"><a href="#cb33-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-628"><a href="#cb33-628" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prediction plot</span></span>
<span id="cb33-629"><a href="#cb33-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-630"><a href="#cb33-630" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE,fig.show='hide',results='hide'}</span></span>
<span id="cb33-631"><a href="#cb33-631" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate predictions</span></span>
<span id="cb33-632"><a href="#cb33-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-633"><a href="#cb33-633" aria-hidden="true" tabindex="-1"></a><span class="co">#' predict' base r to calculate predictions and confidence intervals</span></span>
<span id="cb33-634"><a href="#cb33-634" aria-hidden="true" tabindex="-1"></a>ed_climate<span class="sc">$</span>predlm <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model)</span>
<span id="cb33-635"><a href="#cb33-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-636"><a href="#cb33-636" aria-hidden="true" tabindex="-1"></a><span class="co"># remove NA</span></span>
<span id="cb33-637"><a href="#cb33-637" aria-hidden="true" tabindex="-1"></a>ed_climate <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(ed_climate)</span>
<span id="cb33-638"><a href="#cb33-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-639"><a href="#cb33-639" aria-hidden="true" tabindex="-1"></a><span class="co">#predict </span></span>
<span id="cb33-640"><a href="#cb33-640" aria-hidden="true" tabindex="-1"></a>predslm.ed <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model, <span class="at">interval =</span> <span class="st">"confidence"</span>)</span>
<span id="cb33-641"><a href="#cb33-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-642"><a href="#cb33-642" aria-hidden="true" tabindex="-1"></a><span class="co">#combine predictions with climate</span></span>
<span id="cb33-643"><a href="#cb33-643" aria-hidden="true" tabindex="-1"></a>datlm <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ed_climate, predslm.ed)</span>
<span id="cb33-644"><a href="#cb33-644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-645"><a href="#cb33-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-646"><a href="#cb33-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-647"><a href="#cb33-647" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb33-648"><a href="#cb33-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-649"><a href="#cb33-649" aria-hidden="true" tabindex="-1"></a><span class="co"># set colour scheme</span></span>
<span id="cb33-650"><a href="#cb33-650" aria-hidden="true" tabindex="-1"></a>my_pal3 <span class="ot">&lt;-</span> rcartocolor<span class="sc">::</span><span class="fu">carto_pal</span>(<span class="at">n =</span> <span class="dv">12</span>, <span class="at">name =</span> <span class="st">"Prism"</span>)[<span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">2</span>)]</span>
<span id="cb33-651"><a href="#cb33-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-652"><a href="#cb33-652" aria-hidden="true" tabindex="-1"></a><span class="co"># rename dormancy release levels</span></span>
<span id="cb33-653"><a href="#cb33-653" aria-hidden="true" tabindex="-1"></a>new_labels2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"20"</span> <span class="ot">=</span> <span class="st">"20"</span>, <span class="st">"30"</span> <span class="ot">=</span> <span class="st">"30  "</span>, <span class="st">"40"</span> <span class="ot">=</span> <span class="st">"40"</span>, <span class="st">"50"</span> <span class="ot">=</span> <span class="st">"50"</span>, <span class="st">"60"</span> <span class="ot">=</span> <span class="st">"60"</span>)</span>
<span id="cb33-654"><a href="#cb33-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-655"><a href="#cb33-655" aria-hidden="true" tabindex="-1"></a><span class="co"># set species order</span></span>
<span id="cb33-656"><a href="#cb33-656" aria-hidden="true" tabindex="-1"></a>datlm<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">factor</span>(datlm<span class="sc">$</span>species, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"CSA"</span>, <span class="st">"CAL"</span>))</span>
<span id="cb33-657"><a href="#cb33-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-658"><a href="#cb33-658" aria-hidden="true" tabindex="-1"></a><span class="co"># plot predicted linear regression with confidence intervals and raw data (points)</span></span>
<span id="cb33-659"><a href="#cb33-659" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datlm, <span class="fu">aes</span>(<span class="at">x =</span> BIO_05 <span class="sc">/</span> <span class="dv">10</span>, <span class="at">y =</span> Estimate, <span class="at">color =</span> species, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb33-660"><a href="#cb33-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.27</span>) <span class="sc">+</span></span>
<span id="cb33-661"><a href="#cb33-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr, <span class="at">colour =</span> <span class="cn">NULL</span>), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb33-662"><a href="#cb33-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fit), <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb33-663"><a href="#cb33-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> my_pal3, <span class="at">name =</span> <span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"C. salviifolius"</span>, <span class="st">"C. albidus"</span>)) <span class="sc">+</span></span>
<span id="cb33-664"><a href="#cb33-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> my_pal3, <span class="at">name =</span> <span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"C. salviifolius"</span>, <span class="st">"C. albidus"</span>)) <span class="sc">+</span></span>
<span id="cb33-665"><a href="#cb33-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb33-666"><a href="#cb33-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-667"><a href="#cb33-667" aria-hidden="true" tabindex="-1"></a><span class="co"># facet grid to divide by dormancy release %</span></span>
<span id="cb33-668"><a href="#cb33-668" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="sc">~</span>dormancy_release, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">germ_per =</span> new_labels2))</span>
<span id="cb33-669"><a href="#cb33-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-670"><a href="#cb33-670" aria-hidden="true" tabindex="-1"></a><span class="co"># axes titles</span></span>
<span id="cb33-671"><a href="#cb33-671" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="st">"Maximum temperature of warmest month (°C)"</span>)) <span class="sc">+</span></span>
<span id="cb33-672"><a href="#cb33-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">" Lower heat threshold (°C)"</span>))</span>
<span id="cb33-673"><a href="#cb33-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-674"><a href="#cb33-674" aria-hidden="true" tabindex="-1"></a><span class="co"># format legend</span></span>
<span id="cb33-675"><a href="#cb33-675" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb33-676"><a href="#cb33-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-677"><a href="#cb33-677" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb33-678"><a href="#cb33-678" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"NA"</span>)</span>
<span id="cb33-679"><a href="#cb33-679" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb33-680"><a href="#cb33-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.19</span>, <span class="fl">0.8</span>), <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>)</span>
<span id="cb33-681"><a href="#cb33-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-682"><a href="#cb33-682" aria-hidden="true" tabindex="-1"></a><span class="co"># legend position</span></span>
<span id="cb33-683"><a href="#cb33-683" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>), <span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb33-684"><a href="#cb33-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Dormancy release (%)"</span>) <span class="sc">+</span></span>
<span id="cb33-685"><a href="#cb33-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.07</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb33-686"><a href="#cb33-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-687"><a href="#cb33-687" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>